function _get(t,e,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=_superPropBase(t,e);if(i){var a=Object.getOwnPropertyDescriptor(i,e);return a.get?a.get.call(n):a.value}})(t,e,n||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var n,i=_getPrototypeOf(t);if(e){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"1V5l":function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i,a=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var n in _classCallCheck(this,t),this.type="replies",e)this[n]=e[n]},r=n("LRne"),o=n("Kqap"),s=n("NJ9Y"),c=n("JIr8"),u=n("w1tV"),l=n("fXoL"),d=n("apsj"),b=n("LsVx"),f=n("h586"),p=n("i2dy"),h=((i=function(){function t(e,n,i,a){_classCallCheck(this,t),this.ticketUploads=e,this.tickets=n,this.uploadQueue=i,this.toast=a,this.reset()}return _createClass(t,[{key:"get",value:function(){return this.model}},{key:"set",value:function(t){this.model=t}},{key:"setBody",value:function(t){this.model.body=t}},{key:"setTicketId",value:function(t){this.ticketId=t}},{key:"isEmpty",value:function(){return 0===this.model.body.length&&0===this.model.uploads.length}},{key:"uploadFiles",value:function(t){var e=this;this.uploadQueue.start(t).pipe(Object(o.a)((function(t,e){return[].concat(_toConsumableArray(t),[e.fileEntry])}),[]),Object(s.a)()).subscribe((function(t){e.model.uploads=[].concat(_toConsumableArray(e.model.uploads),_toConsumableArray(t)),e.save()}))}},{key:"detachUpload",value:function(t){var e=this;this.ticketUploads.detach(this.model.id,t.id).subscribe((function(){var n=e.get().uploads.findIndex((function(e){return e.id===t.id}));e.get().uploads.splice(n,1)}))}},{key:"save",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.isEmpty()){var n=this.tickets.saveDraft(this.ticketId,this.getPayload(e),this.model.id).pipe(Object(c.a)((function(){return Object(r.a)({data:t.get()})})),Object(u.a)());return n.subscribe((function(e){t.set(e.data)})),n}}},{key:"delete",value:function(){this.model.id&&this.tickets.deleteDraft(this.model.id).subscribe(),this.reset()}},{key:"getPayload",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({},{body:this.model.body||null,uploads:this.model.uploads.map((function(t){return t.id}))},t)}},{key:"reset",value:function(){this.set(new a({uploads:[],body:""}))}}]),t}()).\u0275fac=function(t){return new(t||i)(l.Yb(d.a),l.Yb(b.a),l.Yb(f.a),l.Yb(p.b))},i.\u0275prov=l.Kb({token:i,factory:i.\u0275fac,providedIn:"root"}),i)},"2qZP":function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i=n("fXoL"),a=n("tSQ/"),r=n("STbY"),o=n("IzEk"),s=n("mWN8"),c=n("twBr"),u=n("LsVx"),l=n("i2dy"),d=n("NFeN"),b=n("Rd8u"),f=n("ofXK");function p(t,e){if(1&t){var n=i.Vb();i.Ub(0,"button",7),i.bc("click",(function(){i.zc(n);var t=e.$implicit;return i.fc().assignTicketsTo(t.id)})),i.Kc(1),i.Tb()}if(2&t){var a=e.$implicit,r=i.fc();i.Fb("active",r.ticket&&r.ticket.assigned_to==a.id),i.Bb(1),i.Lc(a.email)}}var h=function(){var t=function(){function t(e,n,a,r){_classCallCheck(this,t),this.users=e,this.currentUser=n,this.tickets=a,this.toast=r,this.agents=[],this.assigned=new i.n}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.trigger.menuOpened.pipe(Object(o.a)(1)).subscribe((function(){t.fetchAgents()}))}},{key:"open",value:function(){this.trigger.openMenu()}},{key:"close",value:function(){this.trigger.closeMenu()}},{key:"assignTicketsTo",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.tickets.assign(this.ticketIds?this.ticketIds:[this.ticket.id],e).subscribe((function(){t.ticket&&(t.ticket.assigned_to=e),t.toast.open("Tickets assigned"),t.assigned.emit()}))}},{key:"fetchAgents",value:function(){var t=this;this.users.getAll({permission:a.a,perPage:35}).subscribe((function(e){t.agents=e.filter((function(e){return e.id!==t.currentUser.get("id")}))}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(i.Ob(s.a),i.Ob(c.a),i.Ob(u.a),i.Ob(l.b))},t.\u0275cmp=i.Ib({type:t,selectors:[["assign-ticket-dropdown"]],viewQuery:function(t,e){var n;1&t&&i.Gc(r.d,!0),2&t&&i.vc(n=i.cc())&&(e.trigger=n.first)},inputs:{ticket:"ticket",ticketIds:"ticketIds"},outputs:{assigned:"assigned"},decls:9,vars:7,consts:[[1,"no-style","toolbar-item",3,"matMenuTriggerFor"],["svgIcon","user-custom"],[1,"assign-ticket-menu",3,"overlapTrigger"],["assignTicketMenu","matMenu"],["mat-menu-item","","trans","",1,"anyone-item",3,"click"],["mat-menu-item","","trans","",1,"me-item",3,"click"],["mat-menu-item","","class","agent-item",3,"active","click",4,"ngFor","ngForOf"],["mat-menu-item","",1,"agent-item",3,"click"]],template:function(t,e){if(1&t&&(i.Ub(0,"button",0),i.Pb(1,"mat-icon",1),i.Tb(),i.Ub(2,"mat-menu",2,3),i.Ub(4,"button",4),i.bc("click",(function(){return e.assignTicketsTo()})),i.Kc(5,"Anyone"),i.Tb(),i.Ub(6,"button",5),i.bc("click",(function(){return e.assignTicketsTo(e.currentUser.get("id"))})),i.Kc(7,"Me"),i.Tb(),i.Ic(8,p,2,3,"button",6),i.Tb()),2&t){var n=i.wc(3);i.nc("matMenuTriggerFor",n),i.Bb(2),i.nc("overlapTrigger",!1),i.Bb(2),i.Fb("active",e.ticket&&!e.ticket.assigned_to),i.Bb(2),i.Fb("active",e.ticket&&e.ticket.assigned_to===e.currentUser.get("id")),i.Bb(2),i.nc("ngForOf",e.agents)}},directives:[r.d,d.a,r.e,r.b,b.a,f.s],styles:["assign-ticket-dropdown{position:relative;display:inline-block}.assign-ticket-menu.mat-menu-panel{max-height:500px}.assign-ticket-menu.mat-menu-panel .mat-menu-item.active{background-color:var(--be-hover)}"],encapsulation:2}),t}()},"3H9V":function(t,e,n){"use strict";n.d(e,"a",(function(){return P}));var i=n("yS8O"),a=n("aV6R"),r=n("lxqa"),o=n("wZee"),s=(n("bPOv"),n("Yhcd"),n("jpss"),n("XIHC"),n("QWvX"),n("fXoL")),c=n("QGXG"),u=n("twBr"),l=n("LsVx"),d=n("wWhK"),b=n("9C01"),f=n("ofXK"),p=n("STbY"),h=n("Rd8u"),v=n("bTqV"),g=n("NFeN"),m=n("83jf");function y(t,e){if(1&t&&s.Pb(0,"img",22),2&t){var n=s.fc(2).$implicit;s.oc("src",n.user.avatar,s.Cc),s.oc("alt",n.user.email)}}function k(t,e){1&t&&(s.Ub(0,"span",23),s.Kc(1,"You"),s.Tb())}function T(t,e){if(1&t&&(s.Ub(0,"span"),s.Kc(1),s.Tb()),2&t){var n=s.fc(2).$implicit;s.Bb(1),s.Lc(n.user.display_name)}}function x(t,e){1&t&&(s.Ub(0,"span",24),s.Kc(1,"replied"),s.Tb())}function w(t,e){1&t&&(s.Ub(0,"span",24),s.Kc(1,"started the conversation"),s.Tb())}function I(t,e){1&t&&(s.Ub(0,"span",24),s.Kc(1,"left a note"),s.Tb())}function C(t,e){1&t&&(s.Ub(0,"span",24),s.Kc(1,"created a draft"),s.Tb())}function U(t,e){if(1&t){var n=s.Vb();s.Ub(0,"span",25),s.Ub(1,"button",26),s.bc("click",(function(){s.zc(n);var t=s.fc(2).$implicit;return s.fc().editDraft(t)})),s.Kc(2,"Edit"),s.Tb(),s.Ub(3,"button",27),s.bc("click",(function(){s.zc(n);var t=s.fc(2).$implicit;return s.fc().maybeDeleteReply(t)})),s.Kc(4,"Discard"),s.Tb(),s.Tb()}}function O(t,e){if(1&t&&(s.Sb(0),s.Ub(1,"button",28),s.Pb(2,"mat-icon",29),s.Tb(),s.Rb()),2&t){s.fc();var n=s.wc(19);s.Bb(1),s.nc("matMenuTriggerFor",n)}}function _(t,e){if(1&t){var n=s.Vb();s.Ub(0,"reply-attachment-list",30),s.bc("detached",(function(t){s.zc(n);var e=s.fc(2).$implicit;return s.fc().removeAttachment(e,t)})),s.Tb()}if(2&t){var i=s.fc(2).$implicit;s.nc("attachments",i.uploads)}}function B(t,e){if(1&t){var n=s.Vb();s.Ub(0,"div",3),s.Ic(1,y,1,2,"img",4),s.Ub(2,"div",5),s.Ub(3,"div",6),s.Ub(4,"div",7),s.Ub(5,"span",8),s.Ic(6,k,2,0,"span",9),s.Ic(7,T,2,1,"span",10),s.Tb(),s.Kc(8," "),s.Ic(9,x,2,0,"span",11),s.Ic(10,w,2,0,"span",11),s.Ic(11,I,2,0,"span",11),s.Ic(12,C,2,0,"span",11),s.Ic(13,U,5,0,"span",12),s.Tb(),s.Ub(14,"div",13),s.Ub(15,"span",14),s.Kc(16),s.Tb(),s.Ic(17,O,3,1,"ng-container",10),s.Ub(18,"mat-menu",15,16),s.Ub(20,"div",17),s.bc("click",(function(){s.zc(n);var t=s.fc().$implicit;return s.fc().update(t)})),s.Kc(21,"Edit"),s.Tb(),s.Ub(22,"div",18),s.bc("click",(function(){s.zc(n);var t=s.fc().$implicit;return s.fc().maybeDeleteReply(t)})),s.Kc(23,"Delete"),s.Tb(),s.Ub(24,"div",19),s.bc("click",(function(){s.zc(n);var t=s.fc().$implicit;return s.fc().showOriginalEmail(t)})),s.Kc(25,"Show Original"),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Pb(26,"div",20),s.Ic(27,_,1,1,"reply-attachment-list",21),s.Tb(),s.Tb()}if(2&t){var i=s.fc(),a=i.$implicit,r=i.last,o=s.fc();s.Fb("bounce",a.animated)("my-reply",a.user_id==o.currentUser.get("id")),s.oc("ngClass",a.type),s.Bb(1),s.nc("ngIf",a.user.avatar),s.Bb(5),s.nc("ngIf",o.currentUser.get("id")==a.user.id),s.Bb(1),s.nc("ngIf",o.currentUser.get("id")!=a.user.id),s.Bb(2),s.nc("ngIf",!r&&"replies"===a.type),s.Bb(1),s.nc("ngIf",r&&"replies"===a.type),s.Bb(1),s.nc("ngIf","notes"==a.type),s.Bb(1),s.nc("ngIf","drafts"==a.type),s.Bb(1),s.nc("ngIf","drafts"===a.type),s.Bb(3),s.Lc(a.created_at_formatted),s.Bb(1),s.nc("ngIf",o.currentUser.hasPermission("replies.update")&&"drafts"!==a.type),s.Bb(9),s.nc("innerHTML",a.body,s.Ac),s.Bb(1),s.nc("ngIf",a.uploads.length)}}function R(t,e){if(1&t&&s.Ic(0,B,28,17,"div",2),2&t){var n=e.$implicit,i=s.fc();s.nc("ngIf",i.currentUser.hasPermission("replies.view")||"notes"!==n.type)}}var P=function(){var t=function(){function t(e,n,i,a,r){_classCallCheck(this,t),this.modal=e,this.currentUser=n,this.tickets=i,this.conversation=a,this.backendEvents=r}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.subscription=this.backendEvents.ticketReplyCreated.subscribe((function(e){t.conversation.get().id===e.ticket_id&&(e.animated=!0,t.conversation.replies.add(e))}))}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"ngAfterViewInit",value:function(){o&&o.highlightAll()}},{key:"update",value:function(t){var e=this;this.modal.open(a.a,{reply:t},{panelClass:"update-reply-modal-container"}).afterClosed().subscribe((function(t){t&&e.conversation.replies.replace(t)}))}},{key:"maybeDeleteReply",value:function(t){var e=this;this.modal.show(r.a,{reply:t}).afterClosed().subscribe((function(n){n&&e.conversation.replies.delete(t)}))}},{key:"editDraft",value:function(t){this.conversation.setDraft(t),this.conversation.openEditor(),this.conversation.replies.remove(t.id)}},{key:"showOriginalEmail",value:function(t){var e=this,n="show-original-reply-modal-container";this.tickets.getOriginalEmailForReply(t.id).subscribe((function(t){e.modal.open(i.a,{original:t.data},{panelClass:n})}),(function(){e.modal.open(i.a,null,{panelClass:n})}))}},{key:"removeAttachment",value:function(t,e){t.uploads=t.uploads.filter((function(t){return t.id!==e.id})),this.tickets.updateReply(t.id,{uploads:t.uploads.map((function(t){return t.id}))}).subscribe((function(){}),(function(){}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(s.Ob(c.a),s.Ob(u.a),s.Ob(l.a),s.Ob(d.a),s.Ob(b.a))},t.\u0275cmp=s.Ib({type:t,selectors:[["conversation-replies"]],inputs:{textEditor:"textEditor"},decls:2,vars:1,consts:[[1,"thread"],["ngFor","",3,"ngForOf"],["class","reply animated",3,"bounce","ngClass","my-reply",4,"ngIf"],[1,"reply","animated",3,"ngClass"],["class","user-avatar",3,"src","alt",4,"ngIf"],[1,"reply-body"],[1,"message-header"],[1,"customer"],[1,"customer-name"],["trans","",4,"ngIf"],[4,"ngIf"],["class","text-gray action-text","trans","",4,"ngIf"],["class","draft-actions",4,"ngIf"],[1,"meta"],[1,"date"],[1,"reply-actions-menu"],["replyActionsMenu","matMenu"],["mat-menu-item","","trans","",1,"update-reply-button",3,"click"],["mat-menu-item","","trans","",1,"delete-reply-button",3,"click"],["mat-menu-item","","trans","",1,"show-original-reply-button",3,"click"],[1,"message-body",3,"innerHTML"],[3,"attachments","detached",4,"ngIf"],[1,"user-avatar",3,"src","alt"],["trans",""],["trans","",1,"text-gray","action-text"],[1,"draft-actions"],["type","button","trans","",1,"no-style","edit-draft-button",3,"click"],["type","button","trans","",1,"no-style","delete-draft-button",3,"click"],["mat-icon-button","",3,"matMenuTriggerFor"],["svgIcon","more-vert"],[3,"attachments","detached"]],template:function(t,e){1&t&&(s.Ub(0,"div",0),s.Ic(1,R,1,1,"ng-template",1),s.Tb()),2&t&&(s.Bb(1),s.nc("ngForOf",e.conversation.replies.get()))},directives:[f.s,f.t,f.q,p.e,p.b,h.a,v.b,p.d,g.a,m.a],styles:["conversation-replies{display:block;width:100%}conversation-replies .reply{display:flex;padding:25px;border-top:1px solid var(--be-divider-default)}conversation-replies .reply.notes{background-color:#fffcea;color:#836f60;border-left:3px solid #c8bcb4}conversation-replies .reply.drafts{border-left:3px solid var(--be-accent-default)}conversation-replies .reply.drafts .customer .text-gray{color:var(--be-accent-default)}conversation-replies .reply:last-of-type{border-bottom:1px solid var(--be-divider-default)}conversation-replies .reply .user-avatar{flex:0 0 50px;display:block;width:50px;height:50px;margin-right:20px;-o-object-fit:cover;object-fit:cover;border-radius:4px}conversation-replies .reply .reply-body{flex:1 1 auto;max-width:calc(100% - 70px)}conversation-replies .reply reply-attachment-list{border-top:1px dotted var(--be-divider-default);margin:20px 0 0;padding-top:20px;display:inline-flex}conversation-replies .reply reply-attachment-list>.attachments-list-item:last-of-type{margin-right:0}conversation-replies .message-header{font-size:1.65rem;margin-bottom:15px;display:flex}conversation-replies .message-header .customer{flex:1 1 auto}conversation-replies .message-header .customer .draft-actions{margin-left:10px;vertical-align:text-bottom}conversation-replies .message-header .customer .draft-actions button{border:1px solid var(--be-divider-default);padding:5px 8px;font-size:1.2rem;border-radius:3px;margin-right:6px}conversation-replies .message-header .customer .draft-actions button:hover{background-color:#f7f7f7}conversation-replies .message-header .meta{flex:0 0 100px;color:var(--be-secondary-text);font-size:1.2rem;font-weight:500;margin-right:5px;text-align:right;white-space:nowrap;line-height:23px}conversation-replies .message-header .customer-name{text-transform:capitalize;font-weight:500;color:var(--be-help-center-title-text)}conversation-replies .message-header .text-gray{color:var(--be-secondary-text)}conversation-replies .message-body{max-width:90%;word-wrap:break-word;overflow-x:hidden}conversation-replies .message-body a:hover{text-decoration:underline}conversation-replies .message-body img{max-width:100%}"],encapsulation:2}),t}()},"45UC":function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i=n("wWhK"),a=n("LsVx"),r=n("1V5l"),o=n("KHpT"),s=n("ehXJ"),c=n("/RwR"),u=n("0IaG"),l=n("fXoL"),d=n("QGXG"),b=n("wfim"),f=n("tyNb");function p(t,e){if(1&t){var n=l.Vb();l.Ub(0,"button",4),l.bc("click",(function(){return l.zc(n),l.fc().mergeTickets()})),l.Kc(1,"Merge"),l.Tb()}}var h=function(){var t=function(){function t(e,n,i,a,r,o,s){_classCallCheck(this,t),this.dialogRef=e,this.data=n,this.tickets=i,this.modal=a,this.conversation=r,this.tags=o,this.router=s,this.hydrate()}return _createClass(t,[{key:"close",value:function(t){this.dialogRef.close(t)}},{key:"openTicket",value:function(){this.modal.closeAll(),this.router.navigate(["/mailbox/tickets",this.conversation.get().id],{queryParams:{tagId:this.conversation.getStatus().id}})}},{key:"mergeTickets",value:function(){var t=this;this.modal.show(c.a,{title:"Merge Tickets",body:"Are you sure you want merge this ticket with the original one behind the pop-ups?",bodyBold:"Merged tickets can not be unmerged.",ok:"Merge"}).afterClosed().subscribe((function(e){e&&t.tickets.merge(t.activeTicketId,t.conversation.get().id).subscribe((function(e){t.close(e),t.tags.refresh()}))}))}},{key:"hydrate",value:function(){var t=this;this.activeTicketId=this.data.activeTicketId,this.tickets.get(this.data.ticketId).subscribe((function(e){t.conversation.init(e.ticket)}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(l.Ob(u.h),l.Ob(u.a),l.Ob(a.a),l.Ob(d.a),l.Ob(i.a),l.Ob(b.a),l.Ob(f.f))},t.\u0275cmp=l.Ib({type:t,selectors:[["conversation-modal"]],features:[l.Ab([a.a,i.a,r.a,o.a,s.a])],decls:5,vars:3,consts:[[3,"hideSidebar","hideBackButton"],["toolbar-content","",1,"no-style","icon-button","action",3,"click"],["svgIcon","open-in-browser-custom"],["class","merge-button","mat-raised-button","","color","accent","trans","",3,"click",4,"ngIf"],["mat-raised-button","","color","accent","trans","",1,"merge-button",3,"click"]],template:function(t,e){1&t&&(l.Ub(0,"mat-dialog-content"),l.Ub(1,"conversation",0),l.Ub(2,"button",1),l.bc("click",(function(){return e.openTicket()})),l.Pb(3,"mat-icon",2),l.Tb(),l.Tb(),l.Ic(4,p,2,0,"button",3),l.Tb()),2&t&&(l.Bb(1),l.nc("hideSidebar",!0)("hideBackButton",!0),l.Bb(3),l.nc("ngIf",e.activeTicketId))},styles:[".conversation-modal-container{width:80%;height:calc(100% - 50px)}.conversation-modal-container .mat-dialog-container,.conversation-modal-container .mat-dialog-content,.conversation-modal-container conversation-modal{height:100%;max-height:100%;margin:0;padding:0}.conversation-modal-container .merge-button{position:absolute;top:10px;left:300px}"],encapsulation:2}),t}()},"9VjZ":function(t,e,n){"use strict";n.d(e,"a",(function(){return k}));var i=n("fXoL"),a=n("tyNb"),r=n("oVOl"),o=n("twBr"),s=n("wWhK"),c=n("j/pe"),u=n("pfRy"),l=n("b7Mq"),d=n("qH/R"),b=n("3H9V"),f=n("ofXK"),p=n("FBzJ"),h=n("H4ap"),v=["scrollContainer"];function g(t,e){1&t&&i.Pb(0,"conversation-sidebar")}var m=[[["","toolbar-content",""]]],y=["[toolbar-content]"],k=function(){var t=function(){function t(e,n,i,a,r){_classCallCheck(this,t),this.route=e,this.uploads=n,this.currentUser=i,this.conversation=a,this.el=r,this.hideBackButton=!1,this.hideSidebar=!1}return _createClass(t,[{key:"ngAfterViewInit",value:function(){this.conversation.scrollContainer=this.scrollContainer.nativeElement}},{key:"ngOnInit",value:function(){var t=this;this.route.data.subscribe((function(e){t.conversation.init(e.ticket),t.el.nativeElement.focus()}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(i.Ob(a.a),i.Ob(r.a),i.Ob(o.a),i.Ob(s.a),i.Ob(i.l))},t.\u0275cmp=i.Ib({type:t,selectors:[["conversation"]],viewQuery:function(t,e){var n;1&t&&i.Rc(v,!0),2&t&&i.vc(n=i.cc())&&(e.scrollContainer=n.first)},inputs:{hideBackButton:"hideBackButton",hideSidebar:"hideSidebar"},ngContentSelectors:y,decls:11,vars:3,consts:[[1,"conversation-container"],[3,"hideBackButton"],["conversationInfiniteScroll","",1,"ticket-container"],["scrollContainer",""],[4,"ngIf"],[1,"overlay",3,"isVisible"]],template:function(t,e){1&t&&(i.mc(m),i.Sb(0),i.Ub(1,"div",0),i.Ub(2,"conversation-toolbar",1),i.lc(3),i.Tb(),i.Ub(4,"div",2,3),i.Pb(6,"conversation-header"),i.Pb(7,"conversation-text-editor"),i.Pb(8,"conversation-replies"),i.Tb(),i.Tb(),i.Ic(9,g,1,0,"conversation-sidebar",4),i.Rb(),i.Pb(10,"loading-indicator",5)),2&t&&(i.Bb(2),i.nc("hideBackButton",e.hideBackButton),i.Bb(7),i.nc("ngIf",!e.hideSidebar),i.Bb(1),i.nc("isVisible",e.conversation.replies.isLoading||e.conversation.isLoading))},directives:[c.a,u.a,l.a,d.a,b.a,f.t,p.a,h.a],styles:["conversation{display:flex;position:relative}conversation .conversation-container{flex:1 1 auto;min-width:0;height:calc(100vh - 70px);overflow:auto}conversation .conversation-container.invisible{visibility:hidden}conversation .ticket-container{display:flex;flex-direction:column;height:calc(100% - 60px);overflow:auto}"],encapsulation:2}),t}()},Dbf7:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n("EY2u"),a=n("LRne"),r=n("JIr8"),o=n("5+tZ"),s=n("fXoL"),c=n("LsVx"),u=n("tyNb"),l=function(){var t=function(){function t(e,n){_classCallCheck(this,t),this.tickets=e,this.router=n}return _createClass(t,[{key:"resolve",value:function(t,e){var n=this;return this.tickets.get(+(t.params.ticket_id||t.params.id)).pipe(Object(r.a)((function(){return n.router.navigate(["/help-center/tickets"]),i.a})),Object(o.a)((function(t){return t.ticket?Object(a.a)(t.ticket):(n.router.navigate(["/help-center/tickets"]),i.a)})))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(s.Yb(c.a),s.Yb(u.f))},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},DldP:function(t,e,n){"use strict";n.d(e,"a",(function(){return yt}));var i=n("ofXK"),a=n("3Pt+"),r=n("tyNb"),o=n("j/pe"),s=n("b7Mq"),c=n("3H9V"),u=n("qH/R"),l=n("H4ap"),d=n("qaug"),b=n("45UC"),f=n("9VjZ"),p=n("aV6R"),h=n("PPfr"),v=n("lxqa"),g=n("yS8O"),m=n("X3Ra"),y=n("wWhK"),k=n("Dbf7"),T=n("2qZP"),x=n("EzZJ"),w=n("LsVx"),I=n("IgbF"),C=n("7T94"),U=n("1V5l"),O=n("KHpT"),_=n("ehXJ"),B=n("apsj"),R=n("YHvm"),P=n("Bf/s"),K=n("0IaG"),L=n("MK/P"),S=n("gFpt"),E=n("NFeN"),F=n("STbY"),D=n("bTqV"),A=n("6rvT"),z=n("k3xQ"),M=n("Qu3c"),j=n("X3pI"),V=n("JZOH"),N=n("GSRO"),X=n("pfRy"),q=n("A5z7"),Q=n("fXoL"),$=n("KKQg"),Y=n("ovFL"),G=n("N2vX"),H=n("/zh3"),J=n("nQeM"),W=n("Rd8u"),Z=n("FBzJ"),tt=n("DB1O"),et=n("83jf"),nt=n("mrSG"),it=n("Lm4C"),at=n("sgCb");function rt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Object(nt.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,a,r,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a=t,new Promise((function(t){a.createReader().readEntries((function(e){return t(e)}))}));case 2:i=n.sent,n.t0=regeneratorRuntime.keys(i);case 4:if((n.t1=n.t0()).done){n.next=19;break}if(r=n.t1.value,!(o=i[r]).isDirectory){n.next=12;break}return n.next=10,rt(o,e);case 10:n.next=17;break;case 12:return n.t2=e,n.next=15,ot(o);case 15:n.t3=n.sent,n.t2.push.call(n.t2,n.t3);case 17:n.next=4;break;case 19:return n.abrupt("return",e);case 20:case"end":return n.stop()}}),n)})))}function ot(t){return new Promise((function(e){t.file((function(n){e(new at.a(n,t.fullPath))}))}))}var st,ct,ut=((st=function(){function t(e){_classCallCheck(this,t),this.el=e,this.disableDropzoneClick=!1,this.disableDropzone=!1,this.uploadConfig={},this.filesDropped=new Q.n}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this,e=this.el.nativeElement;e.addEventListener("dragenter",(function(e){return t.handleDragEnter(e)})),e.addEventListener("dragover",(function(e){return t.handleDragOver(e)})),e.addEventListener("dragleave",(function(e){return t.handleDragLeave(e)})),e.addEventListener("drop",(function(e){return t.handleDrop(e)})),this.disableDropzoneClick||(this.clickButton?this.clickButton.nativeElement:e).addEventListener("click",(function(){return t.handleClick()}))}},{key:"ngOnDestroy",value:function(){this.removeClassesFromDropzone()}},{key:"handleClick",value:function(){var t=this;this.disableDropzone||Object(it.a)(this.uploadConfig).then((function(e){t.emitUploadEvent(e)}))}},{key:"handleDragEnter",value:function(t){this.dropzoneDisabled(t)||this.el.nativeElement.classList.add("file-over-dropzone")}},{key:"handleDragOver",value:function(t){return t.preventDefault&&t.preventDefault(),t.dataTransfer.dropEffect=this.dropzoneDisabled(t)?"none":"move",!1}},{key:"handleDragLeave",value:function(t){var e=document.elementFromPoint(t.clientX,t.clientY);this.el.nativeElement.contains(e)||this.removeClassesFromDropzone()}},{key:"handleDrop",value:function(t){return Object(nt.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopPropagation(),t.preventDefault(),this.removeClassesFromDropzone(),!this.dropzoneDisabled(t)&&t.dataTransfer.items){e.next=2;break}return e.abrupt("return");case 2:if(n=Array.from(t.dataTransfer.items).filter((function(t){return"file"===t.kind})).map((function(t){return t.webkitGetAsEntry()})),e.t0=n.length,!e.t0){e.next=10;break}return e.t1=this,e.next=8,function(t){return Object(nt.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],e.t0=regeneratorRuntime.keys(t);case 2:if((e.t1=e.t0()).done){e.next=20;break}if(i=e.t1.value,!(a=t[i]).isDirectory){e.next=13;break}return e.t2=n,e.next=9,rt(a);case 9:e.t3=e.sent,n=e.t2.concat.call(e.t2,e.t3),e.next=18;break;case 13:return e.t4=n,e.next=16,ot(a);case 16:e.t5=e.sent,e.t4.push.call(e.t4,e.t5);case 18:e.next=2;break;case 20:return e.abrupt("return",n);case 21:case"end":return e.stop()}}),e)})))}(n);case 8:e.t2=e.sent,e.t1.emitUploadEvent.call(e.t1,e.t2);case 10:case"end":return e.stop()}}),e,this)})))}},{key:"emitUploadEvent",value:function(t){this.filesDropped.emit(t)}},{key:"removeClassesFromDropzone",value:function(){this.el.nativeElement.classList.remove("file-over-dropzone")}},{key:"dropzoneDisabled",value:function(t){var e=t.dataTransfer.types.find((function(t){return"files"===t.toLowerCase()}));return this.disableDropzone||!e}}]),t}()).\u0275fac=function(t){return new(t||st)(Q.Ob(Q.l))},st.\u0275dir=Q.Jb({type:st,selectors:[["","fileDropzone",""]],inputs:{disableDropzoneClick:"disableDropzoneClick",disableDropzone:"disableDropzone",clickButton:"clickButton",uploadConfig:["fileDropzone","uploadConfig"]},outputs:{filesDropped:"filesDropped"}}),st),lt=n("DzUk"),dt=n("rG4v"),bt=n("XRKU"),ft=n("cH1L"),pt=n("vxfF"),ht=n("zW5C"),vt=n("iB19"),gt=n("6SKC"),mt=n("sTxL"),yt=((ct=function t(){_classCallCheck(this,t)}).\u0275mod=Q.Mb({type:ct}),ct.\u0275inj=Q.Lb({factory:function(t){return new(t||ct)},providers:[m.a,y.a,O.a,w.a,B.a,k.a,I.a,U.a,_.a],imports:[[i.c,a.o,a.E,r.j,R.a,P.a,S.a,A.a,z.a,j.a,V.a,N.a,L.a,M.b,K.g,E.b,F.c,D.c,q.g]]}),ct);Q.Dc(b.a,[i.q,i.r,i.s,i.t,i.A,i.w,i.x,i.y,i.z,i.u,i.v,a.K,a.z,a.J,a.d,a.A,a.D,a.a,a.G,a.H,a.C,a.u,a.v,a.F,a.q,a.p,a.B,a.b,a.e,a.x,a.y,a.w,a.j,a.m,a.k,a.n,a.g,r.k,r.g,r.i,r.h,r.l,$.a,Y.a,G.a,H.a,J.a,W.a,Z.a,tt.a,et.a,ut,lt.a,dt.a,bt.a,M.a,M.c,ft.b,pt.a,K.e,K.d,K.i,K.f,K.c,E.a,F.e,F.b,F.d,F.a,D.b,D.a,q.d,q.a,q.c,q.e,q.b,q.f,o.a,s.a,c.a,u.a,l.a,d.a,b.a,f.a,p.a,C.a,h.a,v.a,g.a,T.a,x.a,X.a],[i.b,i.G,i.p,i.k,i.E,i.g,i.C,i.F,i.d,i.f,i.i,i.j,i.l,ht.a,vt.a,gt.a,mt.a])},EzZJ:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var i=n("fXoL"),a=n("3Pt+"),r=n("Kj3r"),o=n("/uUt"),s=n("STbY"),c=n("LsVx"),u=n("IgbF"),l=n("i2dy"),d=n("NFeN"),b=n("ofXK");function f(t,e){if(1&t){var n=i.Vb();i.Ub(0,"button",7),i.bc("click",(function(){i.zc(n);var t=e.$implicit;return i.fc().addTag(t.name)})),i.Kc(1),i.Tb()}if(2&t){var a=e.$implicit;i.Bb(1),i.Lc(a.name)}}var p=function(){var t=function(){function t(e,n,r){_classCallCheck(this,t),this.tickets=e,this.tagService=n,this.toast=r,this.ticketIds=[],this.tagAdded=new i.n,this.tagQuery=new a.i,this.searchedOnce=!1,this.trackByFn=function(t,e){return e.id}}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.bindTagQueryInput(),this.trigger.menuOpened.subscribe((function(){t.searchedOnce||t.searchForTags(null,{perPage:5})})),this.trigger.menuClosed.subscribe((function(){t.clearSearchField()}))}},{key:"open",value:function(){this.trigger.openMenu()}},{key:"close",value:function(){this.trigger.closeMenu()}},{key:"addTag",value:function(t){var e=this;this.tickets.addTag(t,this.ticketIds).subscribe((function(t){e.clearSearchField(),e.toast.open("Tag added"),e.tagAdded.emit(t.data),e.close()}))}},{key:"clearSearchField",value:function(){this.tagQuery.value&&this.tagQuery.setValue(null)}},{key:"bindTagQueryInput",value:function(){var t=this;this.tagQuery.valueChanges.pipe(Object(r.a)(300),Object(o.a)()).subscribe((function(e){t.searchForTags(e)}))}},{key:"searchForTags",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.tagService.search(t,n).subscribe((function(t){return e.tags=t.pagination.data}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(i.Ob(c.a),i.Ob(u.a),i.Ob(l.b))},t.\u0275cmp=i.Ib({type:t,selectors:[["add-tag-dropdown"]],viewQuery:function(t,e){var n;1&t&&i.Gc(s.d,!0),2&t&&i.vc(n=i.cc())&&(e.trigger=n.first)},inputs:{ticketIds:"ticketIds"},outputs:{tagAdded:"tagAdded"},decls:7,vars:5,consts:[[1,"no-style","add-tag-button","toolbar-item",3,"matMenuTriggerFor"],["svgIcon","add-tag-custom"],[1,"add-tag-menu",3,"overlapTrigger"],["addTagMenu","matMenu"],[1,"input-container",3,"ngSubmit","click"],["type","text","mat-menu-item","",1,"tag-search-input",3,"formControl"],["mat-menu-item","","class","tag-item",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],["mat-menu-item","",1,"tag-item",3,"click"]],template:function(t,e){if(1&t&&(i.Ub(0,"button",0),i.Pb(1,"mat-icon",1),i.Tb(),i.Ub(2,"mat-menu",2,3),i.Ub(4,"form",4),i.bc("ngSubmit",(function(){return e.addTag(e.tagQuery.value)}))("click",(function(t){return t.stopPropagation()})),i.Pb(5,"input",5),i.Tb(),i.Ic(6,f,2,1,"button",6),i.Tb()),2&t){var n=i.wc(3);i.nc("matMenuTriggerFor",n),i.Bb(2),i.nc("overlapTrigger",!1),i.Bb(3),i.nc("formControl",e.tagQuery),i.Bb(1),i.nc("ngForOf",e.tags)("ngForTrackBy",e.trackByFn)}},directives:[s.d,d.a,s.e,a.K,a.v,a.w,a.d,s.b,a.u,a.j,b.s],styles:["[_nghost-%COMP%]{position:relative;display:inline-block}.input-container[_ngcontent-%COMP%]{padding:2px 10px 10px}.mat-menu-item[_ngcontent-%COMP%]:first-of-type{border-top:1px solid var(--be-divider-default)}"]}),t}()},H4ap:function(t,e,n){"use strict";n.d(e,"a",(function(){return R}));var i=n("45UC"),a=n("8RV8"),r=n("fXoL"),o=n("QGXG"),s=n("LsVx"),c=n("wWhK"),u=n("tyNb"),l=n("i2dy"),d=n("ofXK"),b=n("Rd8u"),f=n("NFeN"),p=n("bTqV"),h=n("STbY"),v=n("A5z7"),g=n("Qu3c"),m=n("zW5C"),y=n("iB19");function k(t,e){if(1&t&&(r.Ub(0,"mat-chip",26),r.Kc(1),r.Tb()),2&t){var n=e.$implicit;r.Bb(1),r.Lc(n.display_name)}}function T(t,e){if(1&t&&(r.Ub(0,"div",23),r.Ub(1,"mat-chip-list",24),r.Ic(2,k,2,1,"mat-chip",25),r.Tb(),r.Tb()),2&t){var n=r.fc(2);r.Bb(1),r.nc("selectable",!1),r.Bb(1),r.nc("ngForOf",n.requester.tags)}}function x(t,e){if(1&t&&(r.Ub(0,"div",15),r.Pb(1,"mat-icon",34),r.Ub(2,"a",35),r.Kc(3),r.Tb(),r.Tb()),2&t){var n=r.fc(3);r.Bb(2),r.nc("href","https://codecanyon.net/user/"+n.envatoPurchase.envato_username,r.Cc)("title",n.envatoPurchase.envato_username),r.Bb(1),r.Lc(n.envatoPurchase.envato_username)}}function w(t,e){if(1&t&&(r.Ub(0,"div",36),r.gc(1,"trans"),r.Pb(2,"mat-icon",37),r.Ub(3,"span"),r.Kc(4),r.gc(5,"formattedDate"),r.Tb(),r.Tb()),2&t){var n=r.fc(3);r.nc("matTooltip",r.hc(1,2,"Supported until")),r.Bb(4),r.Lc(r.hc(5,4,n.envatoPurchase.supported_until))}}function I(t,e){if(1&t&&(r.Ub(0,"div",38),r.Pb(1,"img",39),r.Ub(2,"div",40),r.Kc(3),r.Tb(),r.Tb()),2&t){var n=e.$implicit;r.Bb(1),r.nc("src",n.image,r.Cc),r.Bb(2),r.Lc(n.item_name)}}function C(t,e){if(1&t&&(r.Ub(0,"div",27),r.Ub(1,"div",28),r.Ub(2,"span",29),r.Kc(3,"Envato"),r.Tb(),r.Tb(),r.Ic(4,x,4,3,"div",30),r.Ic(5,w,6,6,"div",31),r.Ub(6,"div",32),r.Ic(7,I,4,2,"div",33),r.gc(8,"slice"),r.Tb(),r.Tb()),2&t){var n=r.fc(2);r.Bb(4),r.nc("ngIf",n.envatoPurchase.envato_username),r.Bb(1),r.nc("ngIf",n.envatoPurchase.supported_until),r.Bb(2),r.nc("ngForOf",r.jc(8,3,n.requester.purchase_codes,0,5))}}var U=function(t){return["/mailbox/users",t]};function O(t,e){if(1&t){var n=r.Vb();r.Ub(0,"div",7),r.Ub(1,"a",8),r.Pb(2,"img",9),r.Tb(),r.Ub(3,"div",10),r.Ub(4,"div",11),r.Ub(5,"div",12),r.Kc(6),r.Tb(),r.Ub(7,"button",13),r.Pb(8,"mat-icon",14),r.Tb(),r.Tb(),r.Ub(9,"div",15),r.Pb(10,"mat-icon",16),r.Ub(11,"span",17),r.Kc(12),r.Tb(),r.Tb(),r.Ub(13,"mat-menu",null,18),r.Ub(15,"a",19),r.Kc(16,"Edit Profile"),r.Tb(),r.Ub(17,"button",20),r.bc("click",(function(){return r.zc(n),r.fc().changeCustomer()})),r.Kc(18,"Change Customer"),r.Tb(),r.Tb(),r.Ic(19,T,3,2,"div",21),r.Ic(20,C,9,7,"div",22),r.Tb(),r.Tb()}if(2&t){var i=r.wc(14),a=r.fc();r.Bb(1),r.nc("routerLink",r.sc(10,U,a.requester.id)),r.Bb(1),r.nc("src",a.requester.avatar,r.Cc),r.Bb(3),r.nc("title",a.requester.display_name),r.Bb(1),r.Lc(a.requester.display_name),r.Bb(1),r.nc("matMenuTriggerFor",i),r.Bb(4),r.nc("title",a.requester.email),r.Bb(1),r.Lc(a.requester.email),r.Bb(3),r.nc("routerLink",r.sc(12,U,a.requester.id)),r.Bb(4),r.nc("ngIf",a.requester.tags.length),r.Bb(1),r.nc("ngIf",a.envatoPurchase)}}function _(t,e){if(1&t){var n=r.Vb();r.Ub(0,"div",43),r.bc("click",(function(){r.zc(n);var t=e.$implicit;return r.fc(2).openTicketModal(t.id)})),r.Pb(1,"mat-icon",16),r.Ub(2,"span"),r.Kc(3),r.Tb(),r.Tb()}if(2&t){var i=e.$implicit;r.Fb("open",!i.closed_at),r.Bb(3),r.Lc(i.subject)}}function B(t,e){if(1&t&&(r.Ub(0,"div",41),r.Ic(1,_,4,3,"div",42),r.Tb()),2&t){var n=r.fc();r.Bb(1),r.nc("ngForOf",n.otherTickets)}}var R=function(){var t=function(){function t(e,n,i,a,r){_classCallCheck(this,t),this.modal=e,this.tickets=n,this.conversation=i,this.route=a,this.toast=r,this.previousTicketsVisible=!0}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.route.data.subscribe((function(e){t.activeTicket=e.ticket,t.loadUserData()}))}},{key:"openTicketModal",value:function(t){var e=this,n={ticketId:t,activeTicketId:this.conversation.get().id};this.modal.open(i.a,n,{panelClass:"conversation-modal-container"}).afterClosed().subscribe((function(n){n&&(e.otherTickets=e.otherTickets.filter((function(e){return e.id!==t})),e.conversation.init(n))}))}},{key:"getUserTicketsExceptCurrent",value:function(){var t=this;this.requester&&this.tickets.getTickets({userId:this.requester.id,perPage:6}).subscribe((function(e){t.otherTickets=e.pagination.data.filter((function(e){return e.id!==t.activeTicket.id}))}))}},{key:"setEnvatoPurchase",value:function(){var t=this.conversation.getCategory();if(this.requester.purchase_codes.length){if(t)var e=t.name.toLowerCase(),n=this.requester.purchase_codes.find((function(t){return t.item_name.toLowerCase().indexOf(e)>-1}));this.envatoPurchase=n||this.requester.purchase_codes[0]}}},{key:"changeCustomer",value:function(){var t=this;this.modal.open(a.a).beforeClosed().subscribe((function(e){e&&t.tickets.update(t.activeTicket.id,{user_id:e.id}).subscribe((function(){t.requester=e,t.loadUserData(),t.toast.open("Customer changed.")}))}))}},{key:"loadUserData",value:function(){this.requester=this.activeTicket.user,this.getUserTicketsExceptCurrent(),this.setEnvatoPurchase()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(r.Ob(o.a),r.Ob(s.a),r.Ob(c.a),r.Ob(u.a),r.Ob(l.b))},t.\u0275cmp=r.Ib({type:t,selectors:[["conversation-sidebar"]],decls:8,vars:4,consts:[["class","user-info",4,"ngIf"],[1,"tickets-list-container"],[1,"title",3,"click"],["trans","",1,"text"],[1,"no-style","toggle-button"],["svgIcon","keyboard-arrow-down"],["class","tickets-list toggle-container",4,"ngIf"],[1,"user-info"],[1,"avatar",3,"routerLink"],["alt","Avatar",3,"src"],[1,"user-details"],[1,"name"],[1,"text",3,"title"],["mat-icon-button","",3,"matMenuTriggerFor"],["svgIcon","settings"],[1,"info-line"],["svgIcon","mail"],[3,"title"],["editCustomerMenu","matMenu"],["mat-menu-item","","trans","",3,"routerLink"],["mat-menu-item","","trans","",3,"click"],["class","user-tags",4,"ngIf"],["class","info-container",4,"ngIf"],[1,"user-tags"],[3,"selectable"],["class","mat-compact-chip",4,"ngFor","ngForOf"],[1,"mat-compact-chip"],[1,"info-container"],[1,"info-title"],["trans",""],["class","info-line",4,"ngIf"],["class","info-line",3,"matTooltip",4,"ngIf"],[1,"envato-purchases"],["class","purchase-item",4,"ngFor","ngForOf"],["svgIcon","person"],["target","_blank",3,"href","title"],[1,"info-line",3,"matTooltip"],["svgIcon","access-time"],[1,"purchase-item"],["alt","Purchase image",3,"src"],[1,"purchase-name"],[1,"tickets-list","toggle-container"],["class","ticket",3,"open","click",4,"ngFor","ngForOf"],[1,"ticket",3,"click"]],template:function(t,e){1&t&&(r.Ic(0,O,21,14,"div",0),r.Ub(1,"div",1),r.Ub(2,"div",2),r.bc("click",(function(){return e.previousTicketsVisible=!e.previousTicketsVisible})),r.Ub(3,"span",3),r.Kc(4,"Other Conversations"),r.Tb(),r.Ub(5,"button",4),r.Pb(6,"mat-icon",5),r.Tb(),r.Tb(),r.Ic(7,B,2,1,"div",6),r.Tb()),2&t&&(r.nc("ngIf",e.requester),r.Bb(1),r.Fb("tickets-visible",e.previousTicketsVisible),r.Bb(6),r.nc("ngIf",e.otherTickets))},directives:[d.t,b.a,f.a,u.i,p.b,h.d,h.e,h.b,v.d,d.s,v.a,g.a],pipes:[d.E,m.a,y.a],styles:["conversation-sidebar{display:block;flex:0 0 240px;width:240px;background-color:var(--be-background-alternative);border-left:1px solid var(--be-divider-default)}@media screen and (max-width:768px){conversation-sidebar{display:none}}conversation-sidebar .user-tags{margin-top:10px}conversation-sidebar .user-info{margin:15px 15px 10px;border-bottom:1px solid var(--be-divider-default);padding-bottom:10px}conversation-sidebar .user-info .avatar{display:block;width:100%;text-align:center;margin-bottom:10px}conversation-sidebar .user-info .avatar img{max-width:55px;max-height:65px;margin:0 auto;border-radius:4px}conversation-sidebar .user-info .user-details{color:var(--be-secondary-text)}conversation-sidebar .user-info .user-details a{color:inherit}conversation-sidebar .user-info .user-details .name{display:flex;align-items:center;font-size:1.7rem;max-height:24px}conversation-sidebar .user-info .user-details .name .text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}conversation-sidebar .user-info .user-details .name .mat-icon-button{margin-left:auto;color:var(--be-secondary-text);flex-shrink:0}conversation-sidebar .user-info .user-details .info-container{margin-top:10px;padding-top:10px;border-top:1px solid var(--be-divider-default)}conversation-sidebar .user-info .user-details .envato-purchases{margin-top:15px}conversation-sidebar .user-info .user-details .purchase-item{display:flex;align-items:center;white-space:nowrap;margin-bottom:8px}conversation-sidebar .user-info .user-details .purchase-item img{width:25px;height:25px;margin-right:8px;border-radius:4px}conversation-sidebar .user-info .user-details .purchase-item .purchase-name{max-width:calc(100% - 30px);overflow:hidden;text-overflow:ellipsis}conversation-sidebar .user-info .user-details .info-title{margin-bottom:4px;font-weight:500}conversation-sidebar .user-info .user-details .info-line{padding:3px 0;overflow:hidden;text-overflow:ellipsis}conversation-sidebar .user-info .user-details .mat-icon{vertical-align:middle;width:18px;height:18px;margin-right:2px}conversation-sidebar .tickets-list-container{padding:0 15px}conversation-sidebar .tickets-list-container .title{position:relative;cursor:pointer}conversation-sidebar .tickets-list-container .title .toggle-button{position:absolute;right:0;top:-2px;color:var(--be-secondary-text)}conversation-sidebar .tickets-list-container .title .toggle-button .mat-icon{transition:all .3s ease}conversation-sidebar .tickets-list-container .tickets-list{margin-top:15px;display:none}conversation-sidebar .tickets-list-container .tickets-list .ticket{color:var(--be-secondary-text);margin-bottom:15px;cursor:pointer}conversation-sidebar .tickets-list-container .tickets-list .ticket .mat-icon{color:var(--be-secondary-text);width:17px;height:17px;vertical-align:middle;margin-right:3px}conversation-sidebar .tickets-list-container .tickets-list .ticket:hover{text-decoration:underline;color:var(--be-text)}conversation-sidebar .tickets-list-container .tickets-list .ticket.open{color:var(--be-text)}conversation-sidebar .tickets-list-container.tickets-visible .tickets-list{display:block}conversation-sidebar .tickets-list-container.tickets-visible .toggle-button .mat-icon{display:inline-block;transform:rotate(180deg)}"],encapsulation:2}),t}()},KHpT:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n("fXoL"),a=n("LsVx"),r=n("i2dy"),o=function(){var t=function(){function t(e,n){_classCallCheck(this,t),this.tickets=e,this.toast=n,this.replies=[],this.currentPage=1,this.lastPage=2,this.isLoading=!1}return _createClass(t,[{key:"get",value:function(){return this.replies}},{key:"add",value:function(t){t&&t.id&&(this.replies.find((function(e){return e.id===t.id}))||this.replies.unshift(t))}},{key:"replace",value:function(t){var e=this.replies.findIndex((function(e){return e.id===t.id}));this.replies[e]=t}},{key:"remove",value:function(t){this.replies=this.replies.filter((function(e){return e.id!==t}))}},{key:"delete",value:function(t){var e=this;this.tickets["drafts"===t.type?"deleteDraft":"deleteReply"](t.id).subscribe((function(){e.remove(t.id),e.toast.open("Deleted successfully")}))}},{key:"loadMore",value:function(){var t=this;this.isLoading||(this.isLoading=!0,this.tickets.getTicketReplies(this.ticketId,this.currentPage+1).subscribe((function(e){t.replies=t.replies.concat(e.pagination.data),t.currentPage=e.pagination.current_page,t.lastPage=e.pagination.last_page,t.isLoading=!1}),(function(){t.isLoading=!1})))}},{key:"canLoadMore",value:function(){return this.currentPage<this.lastPage}},{key:"init",value:function(t,e){this.replies=t.slice(),this.currentPage=1,this.lastPage=2,this.ticketId=e}}]),t}();return t.\u0275fac=function(e){return new(e||t)(i.Yb(a.a),i.Yb(r.b))},t.\u0275prov=i.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},PPfr:function(t,e,n){"use strict";n.d(e,"a",(function(){return B}));var i=n("fXoL"),a=n("3Pt+"),r=n("cuTO"),o=n("7T94"),s=n("Kj3r"),c=n("/uUt"),u=n("eIep"),l=n("JIr8"),d=n("vkgz"),b=n("STbY"),f=n("hLX6"),p=n("LRne"),h=n("U9CY"),v=n("X3Ra"),g=n("twBr"),m=n("QGXG"),y=n("wWhK"),k=n("i2dy"),T=n("bTqV"),x=n("NFeN"),w=n("ofXK"),I=n("Rd8u"),C=["input"];function U(t,e){if(1&t){var n=i.Vb();i.Ub(0,"button",10),i.bc("click",(function(){return i.zc(n),i.fc().showNewCannedReplyModal()})),i.Ub(1,"strong",11),i.Kc(2,"Create new canned reply"),i.Tb(),i.Tb()}}function O(t,e){if(1&t){var n=i.Vb();i.Ub(0,"button",12),i.bc("click",(function(){i.zc(n);var t=e.$implicit;return i.fc().selectCannedReply(t)})),i.Kc(1),i.Tb()}if(2&t){var a=e.$implicit;i.Bb(1),i.Mc(" ",a.name," ")}}function _(t,e){if(1&t){var n=i.Vb();i.Ub(0,"div",13),i.bc("click",(function(t){return i.zc(n),t.stopPropagation()})),i.Ub(1,"div"),i.Ub(2,"span",11),i.Kc(3,"No results found for"),i.Tb(),i.Ub(4,"strong"),i.Kc(5),i.Tb(),i.Tb(),i.Tb()}if(2&t){var a=i.fc();i.Bb(5),i.Lc(a.searchQuery.value)}}var B=function(){var t=function(){function t(e,n,r,o,s){_classCallCheck(this,t),this.cannedRepliesService=e,this.currentUser=n,this.modal=r,this.conversation=o,this.toast=s,this.searchQuery=new a.i,this.onReplySelect=new i.n,this.loadedResultsAtLeastOnce=!1,this.cannedReplies=[]}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.searchQuery.valueChanges.pipe(Object(s.a)(250),Object(c.a)(),Object(u.a)((function(e){return t.getCannedReplies(e)})),Object(l.a)((function(){return Object(p.a)(h.a)}))).subscribe(),this.trigger.menuOpened.subscribe((function(){t.loadedResultsAtLeastOnce||t.getCannedReplies(null,!0).subscribe()}))}},{key:"selectCannedReply",value:function(t){var e=this,n=t.body.replace(/{{([\w.\-]+?)}}/,(function(t,n){return f.pick(n.toLowerCase(),{ticket:e.conversation.get()})||t}));this.onReplySelect.emit(Object.assign(Object.assign({},t),{body:n}))}},{key:"showNewCannedReplyModal",value:function(){var t=this,e=new r.a({body:this.conversation.draft.get().body,uploads:this.conversation.draft.get().uploads});this.modal.open(o.a,{cannedReply:e},{panelClass:"crupdate-canned-reply-modal-container"}).afterClosed().subscribe((function(e){e&&(t.toast.open("Canned reply created."),t.cannedReplies.unshift(e))}))}},{key:"getCannedReplies",value:function(t,e){var n=this;if(!t&&!e)return Object(p.a)(h.a);var i={query:t,user_id:this.currentUser.get("id"),perPage:20,shared:!0};return this.cannedRepliesService.getReplies(i).pipe(Object(d.a)((function(t){n.loadedResultsAtLeastOnce=!0,n.cannedReplies=t.pagination.data})))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(i.Ob(v.a),i.Ob(g.a),i.Ob(m.a),i.Ob(y.a),i.Ob(k.b))},t.\u0275cmp=i.Ib({type:t,selectors:[["canned-replies-dropdown"]],viewQuery:function(t,e){var n;1&t&&(i.Gc(b.d,!0),i.Gc(C,!0)),2&t&&(i.vc(n=i.cc())&&(e.trigger=n.first),i.vc(n=i.cc())&&(e.input=n.first))},inputs:{searchQuery:"searchQuery"},outputs:{onReplySelect:"onReplySelect"},decls:10,vars:6,consts:[["mat-icon-button","",1,"no-style","editor-button",3,"matMenuTriggerFor"],["svgIcon","comment",1,"dropdown-icon"],[1,"canned-reply-menu",3,"overlapTrigger"],["cannedReplyMenu","matMenu"],[1,"input-container",3,"click"],["type","text","mat-menu-item","",1,"canned-reply-search-input",3,"formControl"],["input",""],["class","new-canned-reply","mat-menu-item","","trans","",3,"click",4,"ngIf"],["class","canned-reply","mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["class","no-results",3,"click",4,"ngIf"],["mat-menu-item","","trans","",1,"new-canned-reply",3,"click"],["trans",""],["mat-menu-item","",1,"canned-reply",3,"click"],[1,"no-results",3,"click"]],template:function(t,e){if(1&t&&(i.Ub(0,"button",0),i.Pb(1,"mat-icon",1),i.Tb(),i.Ub(2,"mat-menu",2,3),i.Ub(4,"div",4),i.bc("click",(function(t){return t.stopPropagation()})),i.Pb(5,"input",5,6),i.Tb(),i.Ic(7,U,3,0,"button",7),i.Ic(8,O,2,1,"button",8),i.Ic(9,_,6,1,"div",9),i.Tb()),2&t){var n=i.wc(3);i.nc("matMenuTriggerFor",n),i.Bb(2),i.nc("overlapTrigger",!1),i.Bb(3),i.nc("formControl",e.searchQuery),i.Bb(2),i.nc("ngIf",!e.searchQuery.value),i.Bb(1),i.nc("ngForOf",e.cannedReplies),i.Bb(1),i.nc("ngIf",!e.cannedReplies.length&&e.loadedResultsAtLeastOnce&&e.searchQuery.value)}},directives:[T.b,b.d,x.a,b.e,a.d,b.b,a.u,a.j,w.t,w.s,I.a],styles:["canned-replies-dropdown{display:block}.canned-reply-menu{width:300px}.canned-reply-menu strong{font-weight:500}.canned-reply-menu .input-container{padding:0 10px 10px;border-bottom:1px solid var(--be-divider-default)}.canned-reply-menu .no-results{padding:10px 10px 0;font-size:1.6rem;text-align:center}"],encapsulation:2}),t}()},aV6R:function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var i=n("KKQg"),a=n("0IaG"),r=n("h586"),o=n("fXoL"),s=n("LsVx"),c=n("Rd8u"),u=n("bTqV"),l=n("NFeN"),d=n("rG4v"),b=n("ofXK"),f=n("83jf");function p(t,e){if(1&t&&(o.Ub(0,"div",11),o.Kc(1),o.Tb()),2&t){var n=o.fc();o.Bb(1),o.Lc(n.errors.body)}}function h(t,e){if(1&t&&(o.Ub(0,"div",11),o.Kc(1),o.Tb()),2&t){var n=o.fc();o.Bb(1),o.Lc(n.errors.attachments)}}function v(t,e){if(1&t){var n=o.Vb();o.Ub(0,"reply-attachment-list",12),o.bc("detached",(function(t){return o.zc(n),o.fc().removeAttachment(t)})),o.Tb()}if(2&t){var i=o.fc();o.nc("attachments",i.attachments)}}var g=function(){var t=function(){function t(e,n,i,a){_classCallCheck(this,t),this.dialogRef=e,this.data=n,this.tickets=i,this.uploadQueue=a,this.attachments=[],this.errors={},this.hydrate()}return _createClass(t,[{key:"ngAfterViewInit",value:function(){this.textEditor.focus(),this.textEditor.setContents(this.reply.body)}},{key:"hydrate",value:function(){this.reply=Object.assign({},this.data.reply),this.attachments=this.reply.uploads.slice()}},{key:"close",value:function(t){this.dialogRef.close(t),this.textEditor.destroyEditor()}},{key:"confirm",value:function(){var t=this,e={body:this.textEditor.getContents(),uploads:this.attachments.map((function(t){return t.id}))};this.tickets.updateReply(this.reply.id,e).subscribe((function(e){t.close(e.data)}),(function(e){return t.errors=e.errors}))}},{key:"uploadFiles",value:function(t){var e=this;this.uploadQueue.start(t).subscribe((function(t){e.attachments=[].concat(_toConsumableArray(e.attachments),[t.fileEntry])}))}},{key:"removeAttachment",value:function(t){for(var e=0;e<this.attachments.length;e++)this.attachments[e].id===t.id&&this.attachments.splice(e,1)}}]),t}();return t.\u0275fac=function(e){return new(e||t)(o.Ob(a.h),o.Ob(a.a),o.Ob(s.a),o.Ob(r.a))},t.\u0275cmp=o.Ib({type:t,selectors:[["update-reply-modal"]],viewQuery:function(t,e){var n;1&t&&o.Gc(i.a,!0),2&t&&o.vc(n=o.cc())&&(e.textEditor=n.first)},features:[o.Ab([r.a])],decls:17,vars:4,consts:[[1,"modal-header"],["mat-dialog-title","","trans",""],["type","button","mat-icon-button","","tabindex","-1",1,"close-button",3,"click"],["svgIcon","close"],[1,"many-inputs"],[1,"input-container"],["inlineUploadPrefix","ticket_images",3,"minHeight","onFileUpload"],["class","error",4,"ngIf"],[3,"attachments","detached",4,"ngIf"],["type","button","mat-button","","trans","",1,"cancel-button",3,"click"],["type","submit","mat-raised-button","","color","accent","trans","",1,"submit-button",3,"click"],[1,"error"],[3,"attachments","detached"]],template:function(t,e){1&t&&(o.Ub(0,"div",0),o.Ub(1,"h2",1),o.Kc(2,"Update Reply"),o.Tb(),o.Ub(3,"button",2),o.bc("click",(function(){return e.close()})),o.Pb(4,"mat-icon",3),o.Tb(),o.Tb(),o.Ub(5,"mat-dialog-content",4),o.Ub(6,"div",5),o.Ub(7,"text-editor",6),o.bc("onFileUpload",(function(t){return e.uploadFiles(t)})),o.Tb(),o.Pb(8,"upload-progress-bar"),o.Ic(9,p,2,1,"div",7),o.Ic(10,h,2,1,"div",7),o.Ic(11,v,1,1,"reply-attachment-list",8),o.Tb(),o.Tb(),o.Ub(12,"mat-dialog-actions"),o.Ub(13,"button",9),o.bc("click",(function(){return e.close()})),o.Kc(14,"Cancel"),o.Tb(),o.Ub(15,"button",10),o.bc("click",(function(){return e.confirm()})),o.Kc(16,"Update"),o.Tb(),o.Tb()),2&t&&(o.Bb(7),o.nc("minHeight",300),o.Bb(2),o.nc("ngIf",e.errors.body),o.Bb(1),o.nc("ngIf",e.errors.attachments),o.Bb(1),o.nc("ngIf",e.attachments.length))},directives:[a.i,c.a,u.b,l.a,a.f,i.a,d.a,b.t,a.c,f.a],styles:[".update-reply-modal-container{width:600px}.update-reply-modal-container reply-attachment-list{margin-top:15px}"],encapsulation:2}),t}()},apsj:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n("fXoL"),a=n("LRXf"),r=function(){var t=function(){function t(e){_classCallCheck(this,t),this.httpClient=e}return _createClass(t,[{key:"attach",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i={ids:[]};return i.ids=e.map((function(t){return t.id})),n&&(i.body=n),this.httpClient.post("tickets/"+t+"/attachments",i)}},{key:"detach",value:function(t,e){return this.httpClient.post("drafts/"+t+"/uploads/"+e+"/detach")}}]),t}();return t.\u0275fac=function(e){return new(e||t)(i.Yb(a.a))},t.\u0275prov=i.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},b7Mq:function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var i=n("fXoL"),a=n("LsVx"),r=n("twBr"),o=n("wfim"),s=n("wWhK"),c=n("A5z7"),u=n("ofXK"),l=n("Qu3c"),d=n("NFeN"),b=n("zW5C");function f(t,e){1&t&&(i.Ub(0,"mat-icon",13),i.Kc(1,"cancel"),i.Tb())}function p(t,e){if(1&t){var n=i.Vb();i.Ub(0,"mat-chip",11),i.bc("removed",(function(){i.zc(n);var t=i.fc().$implicit;return i.fc().removeTag(t)})),i.Kc(1),i.Ic(2,f,2,0,"mat-icon",12),i.Tb()}if(2&t){var a=i.fc().$implicit,r=i.fc();i.nc("removable",r.currentUser.hasPermission("tickets.update")),i.Bb(1),i.Mc(" ",a.display_name," "),i.Bb(1),i.nc("ngIf",r.currentUser.hasPermission("tickets.update"))}}function h(t,e){if(1&t&&(i.Sb(0),i.Ic(1,p,3,3,"mat-chip",10),i.Rb()),2&t){var n=e.$implicit;i.Bb(1),i.nc("ngIf","status"!==n.type)}}var v=function(){var t=function(){function t(e,n,i,a){_classCallCheck(this,t),this.tickets=e,this.currentUser=n,this.mailboxTags=i,this.conversation=a}return _createClass(t,[{key:"removeTag",value:function(t){var e=this;this.tickets.removeTag(t,[this.conversation.get().id]).subscribe((function(){e.conversation.get().tags=e.conversation.get().tags.filter((function(e){return e.id!==t.id})),e.mailboxTags.refresh()}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(i.Ob(a.a),i.Ob(r.a),i.Ob(o.a),i.Ob(s.a))},t.\u0275cmp=i.Ib({type:t,selectors:[["conversation-header"]],decls:13,vars:8,consts:[[1,"title-container"],[1,"ticket-subject"],[1,"tags"],[3,"selectable"],[4,"ngFor","ngForOf"],[1,"title-meta"],[1,"ticket-created-at-date"],[1,"actions"],[1,"button","reply-button",3,"matTooltip","click"],["svgIcon","reply"],["class","mat-compact-chip",3,"removable","removed",4,"ngIf"],[1,"mat-compact-chip",3,"removable","removed"],["matChipRemove","","svgIcon","cancel",4,"ngIf"],["matChipRemove","","svgIcon","cancel"]],template:function(t,e){1&t&&(i.Ub(0,"div",0),i.Ub(1,"h2",1),i.Kc(2),i.Tb(),i.Ub(3,"div",2),i.Ub(4,"mat-chip-list",3),i.Ic(5,h,2,1,"ng-container",4),i.Tb(),i.Tb(),i.Tb(),i.Ub(6,"div",5),i.Ub(7,"div",6),i.Kc(8),i.Tb(),i.Ub(9,"div",7),i.Ub(10,"button",8),i.bc("click",(function(){return e.conversation.openEditor()})),i.gc(11,"trans"),i.Pb(12,"mat-icon",9),i.Tb(),i.Tb(),i.Tb()),2&t&&(i.Bb(2),i.Lc(e.conversation.get().subject),i.Bb(2),i.nc("selectable",!1),i.Bb(1),i.nc("ngForOf",e.conversation.model.tags),i.Bb(3),i.Nc("",e.conversation.get().created_at_formatted," (",e.conversation.get().created_at_month,")"),i.Bb(2),i.nc("matTooltip",i.hc(11,6,"Reply (r)")))},directives:[c.d,u.s,l.a,d.a,u.t,c.a,c.e],pipes:[b.a],styles:["conversation-header{display:flex;align-items:center;flex:none;width:100%}conversation-header .title-container{flex:1 1 auto;display:flex;flex-wrap:wrap;align-items:center;padding:5px 10px 5px 25px;margin:15px 0}conversation-header .title-container h2{color:var(--be-help-center-title-text);font-weight:400;font-size:2.5rem;margin:0 15px 0 0}conversation-header .title-container .tags{display:inline-block}conversation-header .title-container .tags .tag-name{display:inline-block;max-width:50px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;vertical-align:sub}conversation-header .title-meta{flex:0 0 100px;white-space:nowrap;font-size:1.6rem;color:var(--be-secondary-text);text-align:right;padding-right:26px}conversation-header .title-meta .actions,conversation-header .title-meta .ticket-created-at-date{display:inline-block;vertical-align:middle}conversation-header .title-meta .reply-button{min-width:0;border:1px solid var(--be-divider-default);border-radius:4px;color:var(--be-secondary-text);margin-left:10px;padding:5px 12px 6px;background-color:var(--be-background-alternative);cursor:pointer}conversation-header .title-meta .reply-button mat-icon{width:19px;height:19px}@media only screen and (max-width:768px){conversation-header{margin-bottom:15px}conversation-header .title-meta .ticket-created-at-date{display:none}}"],encapsulation:2}),t}()},ehXJ:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n("fXoL"),a=n("tyNb"),r=n("i2dy"),o=n("LsVx"),s=n("kmQS"),c=n("wfim"),u=n("ahrr"),l=function(){var t=function(){function t(e,n,i,a,r,o){_classCallCheck(this,t),this.router=e,this.toast=n,this.tickets=i,this.settings=a,this.mailboxTags=r,this.localStorage=o,this.defaultAction=this.settings.get("replies.after_reply_action","next_active_ticket")}return _createClass(t,[{key:"perform",value:function(){if(this.router.url.indexOf("help-center")>-1)this.navigateToCustomerTicketsList();else{switch(this.get()){case"next_active_ticket":this.navigateToNextActiveTicket();break;case"back_to_folder":this.navigateToAgentTicketsList()}this.mailboxTags.refresh()}}},{key:"get",value:function(){return this.localStorage.get("after_reply_action",this.defaultAction)}},{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.defaultAction=t,this.localStorage.set("after_reply_action",t)}},{key:"setTicketId",value:function(t){this.activeTicketId=t}},{key:"navigateToNextActiveTicket",value:function(){var t=this,e=this.mailboxTags.activeTagId$.value;this.tickets.nextActiveTicket(e).subscribe((function(n){n.ticket&&n.ticket.id!==t.activeTicketId?t.router.navigate(["/mailbox/tickets/",n.ticket.id],{queryParams:{tagId:e}}):t.navigateToAgentTicketsList()}))}},{key:"navigateToAgentTicketsList",value:function(){this.router.navigate(["/mailbox/tickets"],{queryParams:{tagId:this.mailboxTags.activeTagId$.value}})}},{key:"navigateToCustomerTicketsList",value:function(t){this.router.navigate(["/help-center/tickets"]),this.toast.open(t||"Your reply was submitted successfully.")}}]),t}();return t.\u0275fac=function(e){return new(e||t)(i.Yb(a.f),i.Yb(r.b),i.Yb(o.a),i.Yb(s.a),i.Yb(c.a),i.Yb(u.a))},t.\u0275prov=i.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},i70M:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n("JIr8"),a=n("5+tZ"),r=n("EY2u"),o=n("LRne"),s=n("fXoL"),c=n("tyNb"),u=n("sPnx"),l=function(){var t=function(){function t(e,n){_classCallCheck(this,t),this.router=e,this.http=n}return _createClass(t,[{key:"resolve",value:function(t){var e=this;return this.http.get("new-ticket/categories").pipe(Object(i.a)((function(){return e.router.navigateByUrl("/"),r.a})),Object(a.a)((function(t){return Object(o.a)(t.tags)})))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(s.Yb(c.f),s.Yb(u.a))},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},"j/pe":function(t,e,n){"use strict";n.d(e,"a",(function(){return P}));var i,a=n("qaug"),r=n("2qZP"),o=n("EzZJ"),s=n("g6kq"),c=n("STbY"),u=n("FtGj"),l=n("fXoL"),d=n("tyNb"),b=n("QGXG"),f=n("twBr"),p=n("LsVx"),h=n("wWhK"),v=n("wfim"),g=n("pLZG"),m=((i=function(){function t(e){_classCallCheck(this,t),this.router=e,this.history=[],this.limit=15}return _createClass(t,[{key:"get",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.history[t]||null}},{key:"getPrevious",value:function(){return this.get(1)}},{key:"back",value:function(){var t=this.getPrevious();return t?this.router.navigate([t.url],{queryParams:t.queryParams}):new Promise((function(t){return t(!1)}))}},{key:"addHistoryItem",value:function(t){var e=t.split("?"),n={};e[1]&&(n=this.parseQueryParams(e[1])),this.history.length>=this.limit&&this.history.splice(1,this.history.length-1),this.history.unshift({url:e[0],queryParams:n})}},{key:"parseQueryParams",value:function(t){var e=new URLSearchParams(t);return console.log(e),{}}},{key:"init",value:function(){var t=this;this.router.events.pipe(Object(g.a)((function(t){return t instanceof d.b}))).subscribe((function(e){t.addHistoryItem(e.urlAfterRedirects)}))}}]),t}()).\u0275fac=function(t){return new(t||i)(l.Yb(d.f))},i.\u0275prov=l.Kb({token:i,factory:i.\u0275fac,providedIn:"root"}),i),y=n("ofXK"),k=n("Qu3c"),T=n("NFeN"),x=n("zW5C"),w=["ticketStatusMenuTrigger"];function I(t,e){1&t&&(l.Ub(0,"a",16),l.gc(1,"trans"),l.Pb(2,"mat-icon",17),l.Tb()),2&t&&l.nc("matTooltip",l.hc(1,1,"Back (b)"))}function C(t,e){if(1&t){var n=l.Vb();l.Ub(0,"button",18),l.bc("click",(function(){l.zc(n);var t=e.$implicit;return l.fc(2).changeTicketStatus(t)})),l.Kc(1),l.Tb()}if(2&t){var i=e.$implicit,a=l.fc(2);l.Fb("active",(null==a.conversation.status?null:a.conversation.status.name)===i.name),l.nc("ngClass",i.name),l.Bb(1),l.Mc(" ",i.display_name||i.name," ")}}var U=function(t){return[t]};function O(t,e){if(1&t){var n=l.Vb();l.Sb(0),l.Ic(1,I,3,3,"a",5),l.Ub(2,"assign-ticket-dropdown",6),l.bc("assigned",(function(){return l.zc(n),l.fc().refreshMailboxTags()})),l.gc(3,"trans"),l.Tb(),l.Ub(4,"button",7),l.bc("click",(function(){return l.zc(n),l.fc().showNoteModal()})),l.gc(5,"trans"),l.Pb(6,"mat-icon",8),l.Tb(),l.Ub(7,"add-tag-dropdown",9),l.bc("tagAdded",(function(t){return l.zc(n),l.fc().addTag(t)})),l.gc(8,"trans"),l.Tb(),l.Ub(9,"button",10,11),l.gc(11,"trans"),l.Pb(12,"mat-icon",12),l.Tb(),l.Ub(13,"mat-menu",13,14),l.Ic(15,C,2,4,"button",15),l.Tb(),l.lc(16),l.Rb()}if(2&t){var i=l.wc(14),a=l.fc();l.Bb(1),l.nc("ngIf",!a.hideBackButton),l.Bb(1),l.nc("ticket",a.conversation.get())("matTooltip",l.hc(3,10,"Assign (a)")),l.Bb(2),l.nc("matTooltip",l.hc(5,12,"Note (n)")),l.Bb(3),l.nc("ticketIds",l.sc(18,U,a.conversation.get().id))("matTooltip",l.hc(8,14,"Tag (t)")),l.Bb(2),l.nc("matMenuTriggerFor",i)("matTooltip",l.hc(11,16,"Status (s)")),l.Bb(4),l.nc("overlapTrigger",!1),l.Bb(2),l.nc("ngForOf",a.mailboxTags.statusTags)}}var _,B=function(){return["tickets.update","replies.create"]},R=["*"],P=((_=function(){function t(e,n,i,a,r,o,s,c,u,l){_classCallCheck(this,t),this.router=e,this.injector=n,this.modals=i,this.route=a,this.currentUser=r,this.tickets=o,this.conversation=s,this.browserEvents=c,this.mailboxTags=u,this.routerHistory=l,this.hideBackButton=!1,this.subscriptions=[]}return _createClass(t,[{key:"ngOnInit",value:function(){this.initKeybinds()}},{key:"changeTicketStatus",value:function(t){var e=this;t&&this.tickets.changeTicketStatus(this.conversation.get().id,t.name).subscribe((function(){e.conversation.performAfterReplyAction(),e.conversation.setStatus(t)}))}},{key:"showNoteModal",value:function(){var t=this;this.modals.open(a.a,{ticketId:this.conversation.get().id},{panelClass:"add-note-modal-container"}).afterClosed().subscribe((function(e){e&&t.addNewNote(e)}))}},{key:"addTag",value:function(t){this.conversation.addTag(t),this.refreshMailboxTags()}},{key:"addNewNote",value:function(t){t&&this.conversation.replies.add(t)}},{key:"refreshMailboxTags",value:function(){this.mailboxTags.refresh()}},{key:"initKeybinds",value:function(){var t=this,e=this.browserEvents.globalKeyDown$.subscribe((function(e){var n=!0;if(!(t.modals.anyDialogOpen()||s.a.userIsTyping()||e.ctrlKey)){switch(e.keyCode){case u.b:t.closeAllMenus(),t.router.navigate(["../"],{relativeTo:t.route});break;case u.a:t.assignTicketDropdown.open();break;case u.l:t.closeAllMenus(),t.showNoteModal();break;case u.w:t.addTagDropdown.open();break;case u.t:t.ticketStatusTrigger.menuOpen?t.handleTicketStatusChangeKeybind("spam"):t.ticketStatusTrigger.openMenu();break;case u.n:t.handleTicketStatusChangeKeybind("open");break;case u.d:t.handleTicketStatusChangeKeybind("closed");break;case u.o:t.handleTicketStatusChangeKeybind("pending");break;default:n=!1}n&&(e.preventDefault(),e.stopPropagation())}}));this.subscriptions.push(e)}},{key:"closeAllMenus",value:function(){this.addTagDropdown.close(),this.assignTicketDropdown.close(),this.ticketStatusTrigger.closeMenu()}},{key:"handleTicketStatusChangeKeybind",value:function(t){this.ticketStatusTrigger.menuOpen&&(this.changeTicketStatus(this.mailboxTags.getTagByIdOrName(t)),this.ticketStatusTrigger.closeMenu())}},{key:"ngOnDestroy",value:function(){this.subscriptions.forEach((function(t){t&&t.unsubscribe()}))}}]),t}()).\u0275fac=function(t){return new(t||_)(l.Ob(d.f),l.Ob(l.s),l.Ob(b.a),l.Ob(d.a),l.Ob(f.a),l.Ob(p.a),l.Ob(h.a),l.Ob(s.a),l.Ob(v.a),l.Ob(m))},_.\u0275cmp=l.Ib({type:_,selectors:[["conversation-toolbar"]],viewQuery:function(t,e){var n;1&t&&(l.Rc(r.a,!0),l.Rc(o.a,!0),l.Rc(w,!0,c.d)),2&t&&(l.vc(n=l.cc())&&(e.assignTicketDropdown=n.first),l.vc(n=l.cc())&&(e.addTagDropdown=n.first),l.vc(n=l.cc())&&(e.ticketStatusTrigger=n.first))},inputs:{hideBackButton:"hideBackButton"},ngContentSelectors:R,decls:7,vars:5,consts:[[1,"left","toolbar-actions"],[4,"ngIf"],[1,"right","ticket-info"],[1,"ticket-number"],[1,"ticket-status",3,"ngClass"],["class","no-style action back-button","routerLink","../","queryParamsHandling","preserve",3,"matTooltip",4,"ngIf"],[1,"action",3,"ticket","matTooltip","assigned"],[1,"action","no-style","add-note-button",3,"matTooltip","click"],["svgIcon","note-custom"],[1,"action",3,"ticketIds","matTooltip","tagAdded"],[1,"no-style","change-ticket-status-button","action",3,"matMenuTriggerFor","matTooltip"],["ticketStatusMenuTrigger",""],["svgIcon","flag-custom"],[1,"ticket-status-menu",3,"overlapTrigger"],["ticketStatusMenu","matMenu"],["mat-menu-item","",3,"active","ngClass","click",4,"ngFor","ngForOf"],["routerLink","../","queryParamsHandling","preserve",1,"no-style","action","back-button",3,"matTooltip"],["svgIcon","return-custom"],["mat-menu-item","",3,"ngClass","click"]],template:function(t,e){1&t&&(l.mc(),l.Ub(0,"div",0),l.Ic(1,O,17,20,"ng-container",1),l.Tb(),l.Ub(2,"div",2),l.Ub(3,"div",3),l.Kc(4),l.Tb(),l.Ub(5,"div",4),l.Kc(6),l.Tb(),l.Tb()),2&t&&(l.Bb(1),l.nc("ngIf",e.currentUser.hasPermissions(l.rc(4,B))),l.Bb(3),l.Mc("#",e.conversation.get().id,""),l.Bb(1),l.nc("ngClass",e.conversation.getStatus().name),l.Bb(1),l.Lc(e.conversation.getStatus().display_name))},directives:[y.t,y.q,r.a,k.a,T.a,o.a,c.d,c.e,y.s,d.i,c.b],pipes:[x.a],styles:["conversation-toolbar{display:block;width:100%;border-bottom:1px solid var(--be-divider-default);height:57px;padding:0 35px 0 10px;white-space:nowrap;color:var(--be-help-center-title-text)}conversation-toolbar .left,conversation-toolbar .right{width:50%;height:100%;display:inline-flex;align-items:center;padding:15px 0}conversation-toolbar .toolbar-actions .action{margin:0 15px;height:26px;width:26px;position:relative;transition:color .2s ease-in-out;color:inherit}conversation-toolbar .toolbar-actions .action:hover{color:var(--be-text)}conversation-toolbar .toolbar-actions .action mat-icon{height:26px;width:26px}conversation-toolbar .ticket-info{justify-content:flex-end;vertical-align:top}conversation-toolbar .ticket-info .ticket-number{font-size:3rem}conversation-toolbar .ticket-info .ticket-status{border:1px solid var(--be-divider-default);border-radius:2px;background-color:var(--be-background-alternative);padding:4px 12px;margin-left:10px;text-transform:uppercase;font-weight:500;font-size:1.1rem;letter-spacing:.02em}conversation-toolbar .ticket-info .ticket-status.open{background-color:var(--be-accent-default);color:var(--be-accent-contrast);border-color:transparent}.ticket-status-menu .mat-menu-item{text-transform:capitalize}.ticket-status-menu .mat-menu-item.active{background-color:var(--be-accent-emphasis)}"],encapsulation:2}),_)},lxqa:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n("0IaG"),a=n("fXoL"),r=n("kmQS"),o=n("Rd8u"),s=n("bTqV"),c=n("NFeN"),u=n("zW5C"),l=function(){var t=function(){function t(e,n,i){_classCallCheck(this,t),this.dialogRef=e,this.data=n,this.settings=i,this.type=this.getDisplayType(n.reply.type)}return _createClass(t,[{key:"close",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.dialogRef.close(t)}},{key:"confirm",value:function(){this.close(!0)}},{key:"getDisplayType",value:function(t){switch(t){case"replies":return"reply";case"notes":return"note";case"drafts":return"draft"}}}]),t}();return t.\u0275fac=function(e){return new(e||t)(a.Ob(i.h),a.Ob(i.a),a.Ob(r.a))},t.\u0275cmp=a.Ib({type:t,selectors:[["confirm-reply-delete-modal"]],decls:18,vars:5,consts:[[1,"modal-header",2,"margin","0"],["mat-dialog-title","","trans",""],["type","button","mat-icon-button","","tabindex","-1",1,"close-button",3,"click"],["svgIcon","close"],["trans",""],["mat-button","","type","button","trans","",1,"cancel-button",3,"click"],["type","submit","mat-raised-button","","trans","",1,"submit-button",3,"color","click"]],template:function(t,e){1&t&&(a.Ub(0,"div",0),a.Ub(1,"h2",1),a.Kc(2),a.Tb(),a.Ub(3,"button",2),a.bc("click",(function(){return e.close()})),a.Pb(4,"mat-icon",3),a.Tb(),a.Tb(),a.Ub(5,"mat-dialog-content"),a.Ub(6,"p"),a.Ub(7,"span",4),a.Kc(8,"Are you sure you want to delete this"),a.Tb(),a.Kc(9," "),a.Ub(10,"span"),a.Kc(11),a.gc(12,"trans"),a.Tb(),a.Tb(),a.Tb(),a.Ub(13,"mat-dialog-actions"),a.Ub(14,"button",5),a.bc("click",(function(){return e.close()})),a.Kc(15,"Close"),a.Tb(),a.Ub(16,"button",6),a.bc("click",(function(){return e.confirm()})),a.Kc(17,"Delete"),a.Tb(),a.Tb()),2&t&&(a.Bb(2),a.Mc("Delete ",e.type,""),a.Bb(9),a.Mc("",a.hc(12,3,e.type),"?"),a.Bb(5),a.nc("color",e.settings.get("vebto.auth.color")))},directives:[i.i,o.a,s.b,c.a,i.f,i.c],pipes:[u.a],encapsulation:2}),t}()},pfRy:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n("fXoL"),a=n("3Nhn"),r=n("wWhK"),o=function(){var t=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,a){var r;return _classCallCheck(this,n),(r=e.call(this)).el=t,r.conversation=i,r.zone=a,r.scrollTargetIsDocument=!1,r}return _createClass(n,[{key:"ngOnInit",value:function(){this.scrollTargetIsDocument&&(this.el=new i.l(document)),_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this)}},{key:"getScrollContainer",value:function(){return document}},{key:"loadMoreItems",value:function(){this.conversation.replies.loadMore()}},{key:"isLoading",value:function(){return this.conversation.replies.isLoading}},{key:"canLoadMore",value:function(){return this.conversation.replies.canLoadMore()}}]),n}(a.a);return t.\u0275fac=function(e){return new(e||t)(i.Ob(i.l),i.Ob(r.a),i.Ob(i.A))},t.\u0275dir=i.Jb({type:t,selectors:[["","conversationInfiniteScroll",""]],inputs:{scrollTargetIsDocument:"scrollTargetIsDocument"},features:[i.yb]}),t}()},"qH/R":function(t,e,n){"use strict";n.d(e,"a",(function(){return D}));var i=n("lxqa"),a=n("g6kq"),r=n("XRKU"),o=n("FtGj"),s=n("703J"),c=n("pLZG"),u=n("IzEk"),l=n("fXoL"),d=n("QGXG"),b=n("twBr"),f=n("wWhK"),p=n("wfim"),h=n("74SX"),v=n("kmQS"),g=n("ahrr"),m=n("ofXK"),y=n("83jf"),k=n("rG4v"),T=n("KKQg"),x=n("Qu3c"),w=n("NFeN"),I=n("bTqV"),C=n("PPfr"),U=n("STbY"),O=n("Rd8u"),_=n("zW5C"),B=["textEditor"];function R(t,e){if(1&t){var n=l.Vb();l.Ub(0,"suggested-articles-dropdown",16),l.bc("articleSelected",(function(t){return l.zc(n),l.fc().insertArticleLink(t)})),l.Tb()}if(2&t){var i=l.fc();l.nc("category",i.conversation.getCategory())}}function P(t,e){if(1&t){var n=l.Vb();l.Ub(0,"div",17),l.Ub(1,"canned-replies-dropdown",18),l.bc("onReplySelect",(function(t){return l.zc(n),l.fc().applyCannedReply(t)})),l.Tb(),l.Tb()}}function K(t,e){if(1&t){var n=l.Vb();l.Ub(0,"button",24),l.bc("click",(function(){l.zc(n);var t=e.$implicit;return l.fc(2).setSelectedStatus(t)})),l.Kc(1),l.Tb()}if(2&t){var i=e.$implicit;l.nc("ngClass",i.name),l.Bb(1),l.Lc(i.display_name)}}function L(t,e){if(1&t&&(l.Sb(0),l.Ub(1,"button",19),l.Ub(2,"span"),l.Kc(3),l.gc(4,"trans"),l.Tb(),l.Pb(5,"mat-icon",20),l.Tb(),l.Ub(6,"mat-menu",21,22),l.Ic(8,K,2,2,"button",23),l.Tb(),l.Rb()),2&t){var n=l.wc(7),i=l.fc();l.Bb(1),l.nc("matMenuTriggerFor",n),l.Bb(2),l.Lc(l.hc(4,4,null==i.selectedStatus?null:i.selectedStatus.display_name)),l.Bb(3),l.nc("overlapTrigger",!1),l.Bb(2),l.nc("ngForOf",i.mailboxTags.statusTags)}}function S(t,e){1&t&&(l.Ub(0,"span",25),l.Kc(1,"Send Reply"),l.Tb())}function E(t,e){1&t&&(l.Ub(0,"span",25),l.Kc(1,"Sending..."),l.Tb())}function F(t,e){if(1&t){var n=l.Vb();l.Sb(0),l.Ub(1,"button",26),l.Pb(2,"mat-icon",27),l.Tb(),l.Ub(3,"mat-menu",28,29),l.Ub(5,"button",30),l.bc("click",(function(){return l.zc(n),l.fc().conversation.afterReplyAction.set("stay_on_page")})),l.Kc(6,"Send and stay on page"),l.Tb(),l.Ub(7,"button",31),l.bc("click",(function(){return l.zc(n),l.fc().conversation.afterReplyAction.set("next_active_ticket")})),l.Kc(8,"Send and next ticket"),l.Tb(),l.Ub(9,"button",32),l.bc("click",(function(){return l.zc(n),l.fc().conversation.afterReplyAction.set("back_to_folder")})),l.Kc(10,"Send and back to folder"),l.Tb(),l.Tb(),l.Rb()}if(2&t){var i=l.wc(4),a=l.fc();l.Bb(1),l.nc("disabled",a.conversation.replySaving)("matMenuTriggerFor",i),l.Bb(2),l.nc("overlapTrigger",!1),l.Bb(2),l.Fb("selected","stay_on_page"===a.conversation.afterReplyAction.get()),l.Bb(2),l.Fb("selected","next_active_ticket"===a.conversation.afterReplyAction.get()),l.Bb(2),l.Fb("selected","back_to_folder"===a.conversation.afterReplyAction.get())}}var D=function(){var t=function(){function t(e,n,i,a,r,o,c,u){_classCallCheck(this,t),this.modal=e,this.currentUser=n,this.conversation=i,this.browserEvents=a,this.mailboxTags=r,this.hcUrls=o,this.settings=c,this.localStorage=u,this.selectedStatus=new s.a,this.subscriptions=[]}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.mailboxTags.allTags$.pipe(Object(c.a)((function(t){return!!t.length})),Object(u.a)(1)).subscribe((function(){t.setSelectedStatus()})),this.initKeybinds(),this.conversation.setEditor(this.textEditor)}},{key:"submitReply",value:function(){var t=this,e={body:this.textEditor.getContents(),status:this.selectedStatus};this.conversation.submitReply(e).subscribe((function(){t.closeEditor()}),(function(){}))}},{key:"saveDraft",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.conversation.draft.save(t)}},{key:"closeEditor",value:function(){this.conversation.closeEditor(),this.conversation.draft.reset(),this.textEditor.reset()}},{key:"saveDraftAndAddToReplies",value:function(){var t=this;this.conversation.draft.isEmpty()?this.closeEditor():this.saveDraft().subscribe((function(e){t.conversation.replies.add(e.data),t.closeEditor()}))}},{key:"maybeDeleteDraft",value:function(){var t=this,e=this.conversation.draft.get();e.id?this.modal.show(i.a,{reply:e}).afterClosed().subscribe((function(e){e&&(t.conversation.draft.delete(),t.closeEditor())})):this.closeEditor()}},{key:"applyCannedReply",value:function(t){var e=this;this.textEditor.insertContents(t.body),setTimeout((function(){e.saveDraft({uploads:t.uploads.map((function(t){return t.id}))})}))}},{key:"setSelectedStatus",value:function(t){if(t)this.localStorage.set("default_status_tag",t.name);else{var e=this.localStorage.get("default_status_tag");t=e?this.mailboxTags.getTagByIdOrName(e):this.currentUser.hasPermission("tickets.update")?this.mailboxTags.getTagByIdOrName("closed"):this.mailboxTags.getTagByIdOrName("open")}this.selectedStatus=t}},{key:"initKeybinds",value:function(){var t=this,e=this.browserEvents.globalKeyDown$.subscribe((function(e){t.modal.anyDialogOpen()||a.a.userIsTyping()||(e.keyCode===o.r&&(t.conversation.openEditor(),t.conversation.scrollContainer.scrollTo({top:0,behavior:"smooth"})),e.keyCode===o.u&&e.ctrlKey&&(t.articleDropdown.focus(),t.conversation.scrollContainer.scrollTo({top:0,behavior:"smooth"})))}));this.subscriptions.push(e),this.textEditor.editor.waitForEditor().then((function(e){e.shortcuts.add("ctrl+191","Search docs",(function(){t.articleDropdown.focus(),t.conversation.scrollContainer.scrollTo({top:0,behavior:"smooth"})}))}))}},{key:"ngOnDestroy",value:function(){this.saveDraft(),this.closeEditor(),this.subscriptions.forEach((function(t){t&&t.unsubscribe()}))}},{key:"insertArticleLink",value:function(t){var e=this.hcUrls.article(t).join("/");this.textEditor.insertLink({target:"blank",href:this.settings.getBaseUrl()+e,text:t.title})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(l.Ob(d.a),l.Ob(b.a),l.Ob(f.a),l.Ob(a.a),l.Ob(p.a),l.Ob(h.a),l.Ob(v.a),l.Ob(g.a))},t.\u0275cmp=l.Ib({type:t,selectors:[["conversation-text-editor"]],viewQuery:function(t,e){var n;1&t&&(l.Gc(B,!0),l.Rc(r.a,!0)),2&t&&(l.vc(n=l.cc())&&(e.textEditor=n.first),l.vc(n=l.cc())&&(e.articleDropdown=n.first))},decls:21,vars:18,consts:[[1,"text-editor-container"],["placeholder","Search docs... (ctrl + /)",3,"category","articleSelected",4,"ngIf"],[3,"attachments","detached"],["inlineUploadPrefix","ticket_images",3,"onChange","onFileUpload","onCtrlEnter"],["textEditor",""],["class","header-actions","customButtons","",4,"ngIf"],["header","",1,"header-actions","last","right"],["type","button",1,"no-style","editor-button","save-draft-button",3,"matTooltip","click"],["svgIcon","check-circle"],["type","button",1,"no-style","editor-button","delete-draft-button",3,"matTooltip","click"],["svgIcon","delete"],["footer","",1,"editor-footer"],[1,"right"],[4,"ngIf"],["type","button","mat-flat-button","","color","accent",1,"submit-button",3,"disabled","click"],["trans","",4,"ngIf"],["placeholder","Search docs... (ctrl + /)",3,"category","articleSelected"],["customButtons","",1,"header-actions"],[3,"onReplySelect"],["type","button","mat-button","",1,"change-status-button",3,"matMenuTriggerFor"],["svgIcon","keyboard-arrow-down",1,"dropdown-icon"],[1,"status-menu",3,"overlapTrigger"],["statusMenu","matMenu"],["mat-menu-item","","trans","",3,"ngClass","click",4,"ngFor","ngForOf"],["mat-menu-item","","trans","",3,"ngClass","click"],["trans",""],["mat-flat-button","","color","accent",1,"dropdown-left","submit-button-addon",3,"disabled","matMenuTriggerFor"],["svgIcon","arrow-drop-down",1,"caret","align-middle"],[1,"default-redirect-menu",3,"overlapTrigger"],["defaultRedirectMenu","matMenu"],["mat-menu-item","","trans","",1,"stay-on-page",3,"click"],["mat-menu-item","","trans","",1,"next-active-ticket",3,"click"],["mat-menu-item","","trans","",1,"back_to_folder",3,"click"]],template:function(t,e){1&t&&(l.Ub(0,"section",0),l.Ic(1,R,1,1,"suggested-articles-dropdown",1),l.Ub(2,"reply-attachment-list",2),l.bc("detached",(function(t){return e.conversation.draft.detachUpload(t)})),l.Tb(),l.Pb(3,"upload-progress-bar"),l.Ub(4,"text-editor",3,4),l.bc("onChange",(function(t){return e.conversation.draft.setBody(t)}))("onFileUpload",(function(t){return e.conversation.draft.uploadFiles(t)}))("onCtrlEnter",(function(){return e.submitReply()})),l.Ic(6,P,2,0,"div",5),l.Ub(7,"div",6),l.Ub(8,"button",7),l.bc("click",(function(){return e.saveDraftAndAddToReplies()})),l.gc(9,"trans"),l.Pb(10,"mat-icon",8),l.Tb(),l.Ub(11,"button",9),l.bc("click",(function(){return e.maybeDeleteDraft()})),l.gc(12,"trans"),l.Pb(13,"mat-icon",10),l.Tb(),l.Tb(),l.Ub(14,"div",11),l.Ub(15,"div",12),l.Ic(16,L,9,6,"ng-container",13),l.Ub(17,"button",14),l.bc("click",(function(){return e.submitReply()})),l.Ic(18,S,2,0,"span",15),l.Ic(19,E,2,0,"span",15),l.Tb(),l.Ic(20,F,11,9,"ng-container",13),l.Tb(),l.Tb(),l.Tb(),l.Tb()),2&t&&(l.Fb("hidden",!e.conversation.isEditorOpen()),l.Bb(1),l.nc("ngIf",e.currentUser.hasPermission("tickets.update")),l.Bb(1),l.nc("attachments",e.conversation.draft.get().uploads),l.Bb(4),l.nc("ngIf",e.currentUser.hasPermission("canned_replies.view")),l.Bb(2),l.Fb("success",e.conversation.draft.get().id),l.nc("matTooltip",l.hc(9,14,"Save Draft")),l.Bb(3),l.nc("matTooltip",l.hc(12,16,"Discard (Esc)")),l.Bb(5),l.nc("ngIf",e.currentUser.hasPermission("tickets.update")),l.Bb(1),l.nc("disabled",e.conversation.replySaving),l.Bb(1),l.nc("ngIf",!e.conversation.replySaving),l.Bb(1),l.nc("ngIf",e.conversation.replySaving),l.Bb(1),l.nc("ngIf",e.currentUser.hasPermission("settings.update")))},directives:[m.t,y.a,k.a,T.a,x.a,w.a,I.b,r.a,C.a,U.d,U.e,m.s,U.b,O.a,m.q],pipes:[_.a],styles:["conversation-text-editor{display:block;width:100%}conversation-text-editor suggested-articles-dropdown .input-container{position:relative;margin-bottom:10px}conversation-text-editor suggested-articles-dropdown .input-container .search-icon{position:absolute;right:0;top:3px;color:var(--be-secondary-text)}conversation-text-editor .text-editor-container{margin:0 25px 25px}conversation-text-editor .attachments-list{border-bottom:1px dotted var(--be-divider-default);padding-bottom:10px}conversation-text-editor .attachments-list .attachments-list-item{background-color:var(--be-background-alternative)}conversation-text-editor .editor-footer .right{height:100%;display:flex;position:absolute;right:0;top:0}conversation-text-editor .editor-footer .right .change-status-button{height:100%;color:var(--be-secondary-text);font-weight:500;text-transform:capitalize}conversation-text-editor .editor-footer .right .change-status-button .mat-icon{width:20px;height:20px;vertical-align:text-bottom}conversation-text-editor .editor-footer .right .submit-button,conversation-text-editor .editor-footer .right .submit-button-addon{height:38px;border-radius:0;font-weight:400;position:relative;top:-1px}conversation-text-editor .editor-footer .right .submit-button-addon{border-left:1px solid var(--be-accent-emphasis);padding:0 7px;min-width:45px}.default-redirect-menu .selected{background-color:var(--be-accent-emphasis)}.status-menu .mat-menu-item{text-transform:capitalize}"],encapsulation:2}),t}()},qaug:function(t,e,n){"use strict";n.d(e,"a",(function(){return w}));var i=n("wWhK"),a=n("0IaG"),r=n("h586"),o=n("nYR2"),s=n("fXoL"),c=n("LsVx"),u=n("oVOl"),l=n("Rd8u"),d=n("bTqV"),b=n("NFeN"),f=n("3Pt+"),p=n("KKQg"),h=n("rG4v"),v=n("ofXK"),g=n("83jf"),m=["textEditor"];function y(t,e){if(1&t&&(s.Ub(0,"div",13),s.Kc(1),s.Tb()),2&t){var n=s.fc();s.Bb(1),s.Lc(n.errors.body)}}function k(t,e){if(1&t&&(s.Ub(0,"div",13),s.Kc(1),s.Tb()),2&t){var n=s.fc();s.Bb(1),s.Lc(n.errors.file)}}function T(t,e){if(1&t&&(s.Ub(0,"div",13),s.Kc(1),s.Tb()),2&t){var n=s.fc();s.Bb(1),s.Lc(n.errors.attachments)}}function x(t,e){if(1&t){var n=s.Vb();s.Ub(0,"reply-attachment-list",14),s.bc("detached",(function(t){return s.zc(n),s.fc().removeAttachment(t)})),s.Tb()}if(2&t){var i=s.fc();s.nc("attachments",i.attachments)}}var w=function(){var t=function(){function t(e,n,i,a,r){_classCallCheck(this,t),this.dialogRef=e,this.data=n,this.ticketService=i,this.uploads=a,this.uploadQueue=r,this.errors={},this.attachments=[],this.loading=!1}return _createClass(t,[{key:"ngOnInit",value:function(){this.textEditor.focus()}},{key:"close",value:function(t){this.textEditor.destroyEditor(),this.dialogRef.close(t)}},{key:"confirm",value:function(){var t=this;this.loading=!0;var e={body:this.textEditor.getContents(),uploads:this.attachments.map((function(t){return t.id}))};this.ticketService.addNote(this.data.ticketId,e).pipe(Object(o.a)((function(){return t.loading=!1}))).subscribe((function(e){t.close(e.data)}),(function(e){return t.errors=e.errors}))}},{key:"uploadFiles",value:function(t){var e=this;this.uploadQueue.start(t).subscribe((function(t){e.attachments=[].concat(_toConsumableArray(e.attachments),[t.fileEntry])}))}},{key:"removeAttachment",value:function(t){for(var e=0;e<this.attachments.length;e++)this.attachments[e].id===t.id&&this.attachments.splice(e,1)}}]),t}();return t.\u0275fac=function(e){return new(e||t)(s.Ob(a.h),s.Ob(a.a),s.Ob(c.a),s.Ob(u.a),s.Ob(r.a))},t.\u0275cmp=s.Ib({type:t,selectors:[["add-note-modal"]],viewQuery:function(t,e){var n;1&t&&s.Gc(m,!0),2&t&&s.vc(n=s.cc())&&(e.textEditor=n.first)},features:[s.Ab([i.a,r.a])],decls:20,vars:6,consts:[[1,"modal-header"],["mat-dialog-title","","trans",""],["type","button","mat-icon-button","","tabindex","-1",1,"close-button",3,"click"],["svgIcon","close"],["ngNativeValidate","",3,"ngSubmit"],[1,"many-inputs"],[1,"input-container"],["inlineUploadPrefix","ticket_images",1,"text-editor",3,"minHeight","onFileUpload"],["textEditor",""],["class","error",4,"ngIf"],[3,"attachments","detached",4,"ngIf"],["type","button","mat-button","","trans","",1,"cancel-button",3,"click"],["type","submit","mat-raised-button","","color","accent","trans","",1,"submit-button",3,"disabled"],[1,"error"],[3,"attachments","detached"]],template:function(t,e){1&t&&(s.Ub(0,"div",0),s.Ub(1,"h2",1),s.Kc(2,"Add Note"),s.Tb(),s.Ub(3,"button",2),s.bc("click",(function(){return e.close()})),s.Pb(4,"mat-icon",3),s.Tb(),s.Tb(),s.Ub(5,"form",4),s.bc("ngSubmit",(function(){return e.confirm()})),s.Ub(6,"mat-dialog-content",5),s.Ub(7,"div",6),s.Ub(8,"text-editor",7,8),s.bc("onFileUpload",(function(t){return e.uploadFiles(t)})),s.Tb(),s.Pb(10,"upload-progress-bar"),s.Ic(11,y,2,1,"div",9),s.Ic(12,k,2,1,"div",9),s.Ic(13,T,2,1,"div",9),s.Ic(14,x,1,1,"reply-attachment-list",10),s.Tb(),s.Tb(),s.Ub(15,"mat-dialog-actions"),s.Ub(16,"button",11),s.bc("click",(function(){return e.close()})),s.Kc(17,"Cancel"),s.Tb(),s.Ub(18,"button",12),s.Kc(19,"Add Note"),s.Tb(),s.Tb(),s.Tb()),2&t&&(s.Bb(8),s.nc("minHeight",300),s.Bb(3),s.nc("ngIf",e.errors.body),s.Bb(1),s.nc("ngIf",e.errors.file),s.Bb(1),s.nc("ngIf",e.errors.attachments),s.Bb(1),s.nc("ngIf",e.attachments.length),s.Bb(4),s.nc("disabled",e.loading))},directives:[a.i,l.a,d.b,b.a,f.v,f.w,a.f,p.a,h.a,v.t,a.c,g.a],styles:[".add-note-modal-container{width:600px}.add-note-modal-container reply-attachment-list{margin-top:15px}"],encapsulation:2}),t}()},sTxL:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i,a=n("XFMS"),r=n("fXoL"),o=((i=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"transform",value:function(t){return t?t.includes("youtube")?"https://www.youtube.com/s/desktop/ca54e1bd/img/favicon.ico":function(t){return t?(Object(a.a)(t)||(t=window.location.protocol+"//"+window.location.host),"https://www.google.com/s2/favicons?domain="+new URL(t).origin):null}(t):null}}]),t}()).\u0275fac=function(t){return new(t||i)},i.\u0275pipe=r.Nb({name:"favicon",type:i,pure:!0}),i)},"tSQ/":function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a}));var i="tickets.update",a=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var n in _classCallCheck(this,t),e)this[n]=e[n]}},wWhK:function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var i=n("fXoL"),a=n("tSQ/"),r=n("703J"),o=n("vkgz"),s=n("1V5l"),c=n("i2dy"),u=n("LsVx"),l=n("KHpT"),d=n("ehXJ"),b=function(){var t=function(){function t(e,n,o,s,c){_classCallCheck(this,t),this.draft=e,this.toast=n,this.tickets=o,this.replies=s,this.afterReplyAction=c,this.isLoading=!1,this.model=new a.b({tags:[]}),this.status=new r.a,this.replySaving=!1,this.editorIsOpen=!1,this.afterInit=new i.n}return _createClass(t,[{key:"get",value:function(){return this.model}},{key:"getStatus",value:function(){return this.status||new r.a}},{key:"getCategory",value:function(){var t=this.model.tags.find((function(t){return"status"!==t.type}));return t&&t.categories?t.categories[0]:null}},{key:"setStatus",value:function(t){t&&(this.status=t)}},{key:"openEditor",value:function(){var t=this;this.editorIsOpen=!0,setTimeout((function(){return t.editor&&t.editor.focus()}))}},{key:"closeEditor",value:function(){this.editorIsOpen=!1}},{key:"isEditorOpen",value:function(){return this.editorIsOpen}},{key:"setEditor",value:function(t){this.editor=t}},{key:"setDraft",value:function(t){this.draft.set(t),this.editor.setContents(t.body)}},{key:"addTag",value:function(t){this.model.tags.find((function(e){return e.id===t.id}))||this.model.tags.unshift(t)}},{key:"submitReply",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.replySaving=!0,this.tickets.saveReply(this.model.id,this.draft.getPayload(e)).pipe(Object(o.a)((function(n){t.replySaving=!1,t.draft.delete(),t.performAfterReplyAction(),t.setStatus(e.status),t.replies.add(n.data)}),(function(){t.toast.open("There was an issue submitting this reply."),t.replySaving=!1,t.isLoading=!1})))}},{key:"performAfterReplyAction",value:function(){this.afterReplyAction.get()&&"stay_on_page"!==this.afterReplyAction.get()&&(this.isLoading=!0),this.afterReplyAction.perform()}},{key:"init",value:function(t){t&&(this.model=t,this.status=t.tags.find((function(t){return"status"===t.type})),this.replies.init(this.model.replies,this.model.id),this.draft.setTicketId(this.model.id),this.afterReplyAction.setTicketId(this.model.id),this.isLoading=!1,this.afterInit.emit())}}]),t}();return t.\u0275fac=function(e){return new(e||t)(i.Yb(s.a),i.Yb(c.b),i.Yb(u.a),i.Yb(l.a),i.Yb(d.a))},t.\u0275prov=i.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},wfim:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n("2Vo4"),a=n("nYR2"),r=n("fXoL"),o=n("LRXf"),s=function(){var t=function(){function t(e){_classCallCheck(this,t),this.httpClient=e,this.allTags$=new i.a([]),this.categoryTags=[],this.statusTags=[],this.activeTagId$=new i.a(null),this.loading$=new i.a(!1),this.allTags$.value.length||this.refresh()}return _createClass(t,[{key:"setTags",value:function(t){t&&(this.allTags$.next(t),this.statusTags=t.filter((function(t){return"status"===t.type})),this.categoryTags=t.filter((function(t){return"category"===t.type})),this.viewTags=t.filter((function(t){return"view"===t.type})))}},{key:"refresh",value:function(){var t=this;this.loading$.next(!0),this.httpClient.get("tags/agent-mailbox").pipe(Object(a.a)((function(){return t.loading$.next(!1)}))).subscribe((function(e){t.setTags(e)}))}},{key:"setActiveTag",value:function(t){this.activeTagId$.next(t||"unassigned")}},{key:"getTagByIdOrName",value:function(t){return this.allTags$.value.find((function(e){return e.id===+t||e.name===t}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(r.Yb(o.a))},t.\u0275prov=r.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},yS8O:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var i=n("0IaG"),a=n("fXoL"),r=n("Rd8u"),o=n("bTqV"),s=n("NFeN"),c=n("ofXK");function u(t,e){if(1&t&&(a.Ub(0,"div",11),a.Ub(1,"div",12),a.Kc(2),a.Tb(),a.Ub(3,"div",13),a.Kc(4),a.Tb(),a.Tb()),2&t){var n=e.$implicit,i=a.fc();a.Bb(2),a.Lc(n),a.Bb(2),a.Lc(i.originalEmail.headers[n])}}function l(t,e){1&t&&(a.Ub(0,"span",14),a.Kc(1,"Could not find original email for this reply."),a.Tb())}function d(t,e){if(1&t&&(a.Ub(0,"pre",15),a.Kc(1),a.Tb()),2&t){var n=a.fc();a.Bb(1),a.Lc(n.originalEmail.body.plain)}}function b(t,e){if(1&t&&(a.Ub(0,"pre",16),a.Kc(1),a.Tb()),2&t){var n=a.fc();a.Bb(1),a.Lc(n.originalEmail.body.html)}}var f=function(){var t=function(){function t(e,n){_classCallCheck(this,t),this.dialogRef=e,this.data=n,this.headerNames=[],this.hydrate()}return _createClass(t,[{key:"close",value:function(){this.dialogRef.close()}},{key:"hydrate",value:function(){this.originalEmail=this.data.original,this.originalEmail&&this.originalEmail.headers&&(this.headerNames=Object.keys(this.originalEmail.headers))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(a.Ob(i.h),a.Ob(i.a))},t.\u0275cmp=a.Ib({type:t,selectors:[["show-original-reply-modal"]],decls:15,vars:4,consts:[[1,"modal-header"],["mat-dialog-title","","trans",""],["type","button","mat-icon-button","","tabindex","-1",1,"close-button",3,"click"],["svgIcon","close"],[1,"headers"],["class","header",4,"ngFor","ngForOf"],[1,"email-content"],["trans","",4,"ngIf"],["class","body-plain",4,"ngIf"],["class","body-html",4,"ngIf"],["type","submit","mat-raised-button","","color","accent","trans","",1,"submit-button",3,"click"],[1,"header"],[1,"name"],[1,"value"],["trans",""],[1,"body-plain"],[1,"body-html"]],template:function(t,e){1&t&&(a.Ub(0,"div",0),a.Ub(1,"h2",1),a.Kc(2,"Original Message"),a.Tb(),a.Ub(3,"button",2),a.bc("click",(function(){return e.close()})),a.Pb(4,"mat-icon",3),a.Tb(),a.Tb(),a.Ub(5,"mat-dialog-content"),a.Ub(6,"div",4),a.Ic(7,u,5,2,"div",5),a.Tb(),a.Ub(8,"div",6),a.Ic(9,l,2,0,"span",7),a.Ic(10,d,2,1,"pre",8),a.Ic(11,b,2,1,"pre",9),a.Tb(),a.Tb(),a.Ub(12,"mat-dialog-actions"),a.Ub(13,"button",10),a.bc("click",(function(){return e.close()})),a.Kc(14,"Done"),a.Tb(),a.Tb()),2&t&&(a.Bb(7),a.nc("ngForOf",e.headerNames),a.Bb(2),a.nc("ngIf",!e.originalEmail),a.Bb(1),a.nc("ngIf",e.originalEmail&&e.originalEmail.body.plain),a.Bb(1),a.nc("ngIf",e.originalEmail&&e.originalEmail.body.html))},directives:[i.i,r.a,o.b,s.a,i.f,c.s,c.t,i.c],styles:[".show-original-reply-modal-container{width:90%;height:90%}.show-original-reply-modal-container .mat-dialog-title{margin-bottom:25px}.show-original-reply-modal-container .mat-dialog-content{max-height:none}.show-original-reply-modal-container .headers{border:1px solid var(--be-divider-default)}.show-original-reply-modal-container .headers>.header{display:flex;padding:10px;border-bottom:1px solid var(--be-divider-default)}.show-original-reply-modal-container .headers>.header>.name{flex:1 1 30%;font-weight:500;max-width:200px}.show-original-reply-modal-container .headers>.header>.value{flex:1 1 65%;margin-left:auto}.show-original-reply-modal-container .email-content{margin-top:40px}.show-original-reply-modal-container .email-content>pre{font-size:1.4rem;font-family:Roboto,Helvetica Neue,sans-serif;word-wrap:break-word;white-space:pre-wrap}.show-original-reply-modal-container .email-content>.body-plain{margin-bottom:20px;padding-bottom:20px;border-bottom:1px solid var(--be-divider-default)}"],encapsulation:2,changeDetection:0}),t}()}}]);